{"version":3,"sources":["webpack://cbkzxtArBasic/webpack/universalModuleDefinition","webpack://cbkzxtArBasic/webpack/bootstrap","webpack://cbkzxtArBasic/external \"THREEx\"","webpack://cbkzxtArBasic/external \"THREE\"","webpack://cbkzxtArBasic/external {\"commonjs\":\"vue\",\"commonjs2\":\"vue\",\"root\":\"Vue\"}","webpack://cbkzxtArBasic/external \"Desc\"","webpack://cbkzxtArBasic/./node_modules/events/events.js","webpack://cbkzxtArBasic/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://cbkzxtArBasic/./src/ArSceneType.ts","webpack://cbkzxtArBasic/./src/ResourceMgr.ts","webpack://cbkzxtArBasic/./src/IndexedDB.ts","webpack://cbkzxtArBasic/./src/IndexFile.ts","webpack://cbkzxtArBasic/./src/HashInfo.ts","webpack://cbkzxtArBasic/./src/HashInfoDiffType.ts","webpack://cbkzxtArBasic/./src/ObjectHelper.ts","webpack://cbkzxtArBasic/./src/HashInfoDiff.ts","webpack://cbkzxtArBasic/./src/IDBFSMergeStep.ts","webpack://cbkzxtArBasic/./src/IDBFSFile.ts","webpack://cbkzxtArBasic/./src/ProcessEvent.ts","webpack://cbkzxtArBasic/./src/IDBFS.ts","webpack://cbkzxtArBasic/./src/FileMgr.ts","webpack://cbkzxtArBasic/./src/MarkerMgr.ts","webpack://cbkzxtArBasic/./src/MathHelper.ts","webpack://cbkzxtArBasic/./src/NumberRange.ts","webpack://cbkzxtArBasic/./src/RangeDesc.ts","webpack://cbkzxtArBasic/./src/ArScene.ts","webpack://cbkzxtArBasic/./src/ArExpScene.ts","webpack://cbkzxtArBasic/./src/TexMgr.ts","webpack://cbkzxtArBasic/./src/MatMgr.ts","webpack://cbkzxtArBasic/./src/ThreeJSHelper.ts","webpack://cbkzxtArBasic/./src/ModelMgr.ts","webpack://cbkzxtArBasic/./src/OrbitValue.ts","webpack://cbkzxtArBasic/./src/ArModelScene.ts","webpack://cbkzxtArBasic/./src/ArRender.ts","webpack://cbkzxtArBasic/./src/ArVideoScene.ts","webpack://cbkzxtArBasic/./src/ArSceneMgr.ts","webpack://cbkzxtArBasic/./src/Loader.ts","webpack://cbkzxtArBasic/./src/ModelRender.ts","webpack://cbkzxtArBasic/./src/OrbitController.ts","webpack://cbkzxtArBasic/./src/lib/comps/ModelViewer.vue?f5aa","webpack://cbkzxtArBasic/./node_modules/tslib/tslib.es6.js","webpack://cbkzxtArBasic/./node_modules/vue-class-component/dist/vue-class-component.esm.js","webpack://cbkzxtArBasic/./node_modules/vue-property-decorator/lib/vue-property-decorator.js","webpack://cbkzxtArBasic/./src/lib/comps/ModelViewer.vue?8404","webpack://cbkzxtArBasic/./src/lib/comps/ModelViewer.vue?c1a4","webpack://cbkzxtArBasic/./node_modules/vue-loader/lib/runtime/componentNormalizer.js","webpack://cbkzxtArBasic/./src/lib/comps/ModelViewer.vue","webpack://cbkzxtArBasic/./src/TSHelper.ts"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE__1ac3__","__WEBPACK_EXTERNAL_MODULE__5fda__","__WEBPACK_EXTERNAL_MODULE__8bbf__","__WEBPACK_EXTERNAL_MODULE_d182__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","ProcessEmitWarning","warning","console","warn","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","events","existing","newListener","emit","unshift","push","length","warned","w","Error","String","emitter","count","onceWrapper","fired","removeListener","wrapFn","arguments","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","unwrapListeners","arrayClone","listenerCount","arr","copy","Array","spliceOne","list","index","pop","ret","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","len","listeners","addListener","on","prependListener","once","prependOnceListener","position","originalListener","shift","off","removeAllListeners","keys","rawListeners","eventNames","window","currentScript","document","src","match","ArSceneType","ResourceMgr","Map","unready","Set","size","ready","total","processCB","descs","regBasicRes","initBasicRes","n_all","emitProgress","desc","make","delete","has","add","IndexedDB","_idb","idb","db","tables","opts","objectStoreNames","contains","store","createObjectStore","param","indexs","createIndex","version","updateFunc","Promise","resolve","reject","req","indexedDB","open","onsuccess","result","onerror","onupgradeneeded","ev","table","readonly","transaction","objectStore","data","reqToPromise","getTable","put","indexName","getKey","getAllKeys","_key","findKey","keyPath","map","cursor","openCursor","continue","IndexFile","text","versionName","generatorName","splitBar","repeat","lineSeparator","columnseparator","datas","join","parseData","split","lines","cleanData","line","parseHeader","substring","headerText","dataText","parseText","replace","slice","columns","HashInfo","_hash","_info","hash","info","another","infoEqualFunc","array","item","HashInfoDiffType","removeUndefProp","obj","assignWhenExist","to","from","assign","eachChild","func","items","parent","children","mapFindIndex","_map","_value","_equalFunc","a","b","mapFind","_type","_left","_right","left","right","_arr","diffs","map_left","toMap","map_right","reInfos","right_hash","right_item","left_item","infoEqual","ReInfo","ReHash","Delete","Add","IDBFSMergeStep","hashDelete","hashAdd","fileDelete","fileAdd","names","super","sort","indexFile","res","entries","compare","steps","diff","url","del","setLeft","setRight","ProcessEvent","ProgressEvent","loaded","lengthComputable","msg","msgs","msgTemplete","action","content","IDBFS","_initing","blobUrlMap","urlBlobMap","files","_version","_versionName","set_id","setVersion","waiter","createFromTables","unique","updateFiles","ver","forEach","Boolean","valueOf","clear","input","startsWith","resServer","fetch","blob","overwrite","findKeys","urlToHash","hashToBlob","urlToBlob","blobUrl","URL","createObjectURL","tryClean","hashToUrl","delUrl","delHash","newUrl","regUrl","cached","addData","calcMergeSteps","fromIndex","cachedIndex","rule","filter","test","calcDiffs","proc","regBlob","fetchBlob","updateVersion","instance","FileMgr","inst","fs","MarkerMgr","fileMgr","_descs","reg","basicReadied","iset","getBlobUrl","fset","fset3","JSON","stringify","marker","toRad","deg","Math","PI","toRads","degs","toDegree","rad","toDegrees","rads","lerp","v","rlerp","circleOut","sqrt","pow","powerOut","stick","ease","delta","sign","log1p","abs","distance","x1","y1","x2","y2","dx","dy","toZero","newEaseFunc","k","Infinity","x","toVec3","xyz","toXYZ","vec3","y","z","min","max","group","initValue","step","unit","val","round","clamp","params","sceneID","title","sceneType","none","camera","onTickFuncs","paramsValue","values","visible","basicDesc","markerMgr","markerUrl","cases","default","scene","setWithDesc","exp","TexMgr","blob_url","tex_loader","load","tex","MatMgr","texMgr","matClass","prop","endsWith","mat","meshesFromDescs","overrideMat","modelMgr","matMgr","meshFromDesc","model","mesh","userData","rotate","rotation","scale","castShadow","receiveShadow","isMesh","mapModels","cleanMat","traverse","child","geometry","material","isArray","dispose","async","importGLTF","onProgress","cb","isUrl","ModelMgr","gltf","log","OrbitValue","rotateX","ranges","rotateY","zoom","center","farRange","zoomToR","sin","r1","cos","zoomRange","ArModelScene","actions","lights","easy","basicLight","shadowLight","groundMat","opacity","ground","_mat","_light","_lightRadius","_initGround","_initLight","updateMat","colorMat","normalMat","remove","_updateLights","startAngle","orbit","lightRadius","cameraPosition","_orbitLights","intensity","_updateEasyLights","_updateComplexLights","shadow","mapSize","origin","color","normal","env","environment","shipBody","metalness","roughness","debugSource","antialias","alpha","_clearNowScene","_setNowScene","_contextReady","_looper_binded","_looper","_onResize_binded","_onResize","_scenes","_timerNewNowScene","funcs","hidden","lastTime","running","addEventListener","setClearAlpha","domElement","classList","_arSource","THREEx","ArToolkitSource","sourceType","_arContext","ArToolkitContext","cameraParametersUrl","detectionMode","_nowScene","_sceneToContext","nowSceneActrual","time","requestAnimationFrame","update","_firstActivedScene","_newNowScene","render","clearTimeout","setTimeout","onResizeElement","copyElementSizeTo","arController","canvas","projectionMatrix","getProjectionMatrix","ArMarkerControls","descriptorsUrl","changeMatrixMode","smoothCount","smoothTolerance","smoothThreshold","smooth","lastScene","getObjectByName","scenes","addScene","container","setSize","offsetWidth","offsetHeight","appendChild","setInterval","pause","videoUrl","video","ArSceneMgr","descIsName","method","fromDesc","descIsModel","_makeScene","descIsVideo","descIsExp","regBasicRes_basic","desc_model","regBasicRes_model","regBasicRes_video","regBasicRes_exp","Loader","_cacheLoaded","_arRender","_resLoaded","toString","loadIndex","e","emitError","mergeTo","find","models","initMgr","mgr","dom","arSource","domTo","loadScenes","start","loadCache","_arScene","_initRender","_initDom","setPixelRatio","devicePixelRatio","shadowMap","enabled","thisOnResize","parentElement","h","resetCamera","aspect","fov","updateProjectionMatrix","arScene","nowState","startX","startY","startDist","startValue","wheelScroll_binded","wheelScroll","touchStart_binded","touchStart","touchMove_binded","touchMove","touchEnd_binded","touchEnd","event","changed","elem","srcElement","PointerEvent","setPointerCapture","pointerId","touches","TouchEvent","clientX","clientY","calcFingerDist","removeEventListener","fixValue","deltaY","continueEvent","preventDefault","updateState","releasePointerCapture","MouseEvent","_vm","_h","$createElement","_c","_self","ref","staticClass","staticRenderFns","__decorate","decorators","getOwnPropertyDescriptor","decorate","_typeof","iterator","constructor","_defineProperty","configurable","writable","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","arr2","iter","reflectionIsSupported","defineMetadata","getOwnMetadataKeys","copyReflectionMetadata","forwardMetadata","propertyKey","metaKeys","metaKey","metadata","getOwnMetadata","fakeArray","__proto__","hasProto","createDecorator","Ctor","__decorators__","options","isPrimitive","collectDataFromConstructor","vm","Component","originalInit","_init","_this","$options","props","charAt","plainData","$internalHooks","componentFactory","_componentTag","proto","indexOf","descriptor","methods","mixins","computed","fn","superProto","Super","Extended","extend","forwardStaticMembers","shouldIgnore","callee","caller","Original","extendedDescriptor","superDescriptor","registerHooks","reflectMetadataIsSupported","getMetadata","applyMetadata","Prop","componentOptions","Watch","path","_a","deep","_b","immediate","watch","ModelViewer","viewController","modelRender","$refs","orbitViewChanged","cameraPosChange","nowScene","lightChanged","matChanged","light","renderShadow","orbitView","listenOn","unlistenOn","pos","lookAt","normalizeComponent","scriptExports","functionalTemplate","injectStyles","scopeId","moduleIdentifier","shadowMode","hook","_compiled","functional","_scopeId","$vnode","ssrContext","__VUE_SSR_CONTEXT__","_registeredComponents","_ssrRegister","$root","shadowRoot","_injectStyles","originalRender","beforeCreate","component","tryAwait","sleep","ms","numsToStr","nums","pad","padStart","yyyymmdd","date","Date","getFullYear","getMonth","getDate","hhmmss","getHours","getMinutes","getSeconds"],"mappings":"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","file":"cbkzxtArBasic.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREEx\"), require(\"THREE\"), require(\"vue\"), require(\"Desc\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREEx\", \"THREE\", , \"Desc\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cbkzxtArBasic\"] = factory(require(\"THREEx\"), require(\"THREE\"), require(\"vue\"), require(\"Desc\"));\n\telse\n\t\troot[\"cbkzxtArBasic\"] = factory(root[\"THREEx\"], root[\"THREE\"], root[\"Vue\"], root[\"Desc\"]);\n})((typeof self !== 'undefined' ? self : this), function(__WEBPACK_EXTERNAL_MODULE__1ac3__, __WEBPACK_EXTERNAL_MODULE__5fda__, __WEBPACK_EXTERNAL_MODULE__8bbf__, __WEBPACK_EXTERNAL_MODULE_d182__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"fae3\");\n","module.exports = __WEBPACK_EXTERNAL_MODULE__1ac3__;","module.exports = __WEBPACK_EXTERNAL_MODULE__5fda__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8bbf__;","module.exports = __WEBPACK_EXTERNAL_MODULE_d182__;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  var currentScript = window.document.currentScript\n  if (process.env.NEED_CURRENTSCRIPT_POLYFILL) {\n    var getCurrentScript = require('@soda/get-current-script')\n    currentScript = getCurrentScript()\n\n    // for backward compatibility, because previously we directly included the polyfill\n    if (!('currentScript' in document)) {\n      Object.defineProperty(document, 'currentScript', { get: getCurrentScript })\n    }\n  }\n\n  var src = currentScript && currentScript.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/)\n  if (src) {\n    __webpack_public_path__ = src[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","enum ArSceneType {\r\n  'none',\r\n  'video',\r\n  'model',\r\n  'exp',\r\n}\r\n\r\nexport default ArSceneType","abstract class ResourceMgr\r\n  <T_DESC = string, T = string, T_KEY = T_DESC>\r\n  extends Map<T_KEY, T>\r\n{\r\n\r\n  processCB?: (\r\n    ready: number,\r\n    total: number,\r\n    mgr: ResourceMgr<T_DESC, T, T_KEY>\r\n  ) => void\r\n\r\n  unready: Set<T_DESC> = new Set()\r\n\r\n  get count() {\r\n    return this.size + this.unready.size\r\n  }\r\n\r\n  emitProgress(ready: number, total: number) {\r\n    if (this.processCB) this.processCB(ready, total, this)\r\n  }\r\n\r\n  regBasicRes(...descs: T_DESC[]) { }\r\n\r\n  async initBasicRes() { }\r\n\r\n  async init(): Promise<any> {\r\n    this.regBasicRes()\r\n    await this.initBasicRes()\r\n    let n_all = this.unready.size\r\n    let n = 0\r\n    this.emitProgress(n, n_all)\r\n    for (let desc of this.unready) {\r\n      await this.make(desc)\r\n      this.unready.delete(desc)\r\n      this.emitProgress(n += 1, n_all)\r\n    }\r\n  }\r\n\r\n  abstract async make(\r\n    desc: T_DESC, basicReadied?: boolean\r\n  ): Promise<T | void>\r\n\r\n  reg(desc: T_DESC) {\r\n    if (!this.has(desc as any) && !this.unready.has(desc))\r\n      this.unready.add(desc)\r\n  }\r\n\r\n}\r\n\r\nexport default ResourceMgr","\r\nclass IndexedDB {\r\n\r\n  readonly idb: IDBDatabase\r\n\r\n  constructor(_idb: IDBDatabase) {\r\n    this.idb = _idb\r\n  }\r\n\r\n  static createFromTables(db: IDBDatabase, tables: IDBTables) {\r\n    for (let [name, opts] of tables)\r\n      if (!db.objectStoreNames.contains(name)) {\r\n        let store = db.createObjectStore(name, opts.param)\r\n        if (opts.indexs)\r\n          for (let index of opts.indexs)\r\n            store.createIndex(...index)\r\n      }\r\n  }\r\n\r\n  static async open(\r\n    name: string,\r\n    version: number,\r\n    updateFunc: IDBVersionUpdateFunc,\r\n  ) {\r\n    return new Promise<IndexedDB>(function (resolve, reject) {\r\n      let req = window.indexedDB.open(name, version)\r\n      req.onsuccess = function () {\r\n        resolve(new IndexedDB(this.result))\r\n      }\r\n      req.onerror = reject\r\n      req.onupgradeneeded = function (ev) {\r\n        updateFunc(this, ev)\r\n      }\r\n    })\r\n  }\r\n\r\n  getTable(table: string, readonly = false) {\r\n    return this.idb.transaction(\r\n      table, readonly ? \"readonly\" : \"readwrite\"\r\n    ).objectStore(table)\r\n  }\r\n\r\n  private static async reqToPromise<T>(req: IDBRequest<T>) {\r\n    return new Promise<T>(function (resolve, reject) {\r\n      req.onerror = reject\r\n      req.onsuccess = function () { resolve(this.result) }\r\n    })\r\n  }\r\n\r\n  async add(table: string, data: any) {\r\n    return IndexedDB.reqToPromise(this.getTable(table).add(data))\r\n  }\r\n\r\n  async put(table: string, data: any) {\r\n    return IndexedDB.reqToPromise(this.getTable(table).put(data))\r\n  }\r\n\r\n  async findKey(\r\n    table: string, key: IDBKey, indexName?: string\r\n  ): Promise<IDBValidKey | undefined> {\r\n    return IndexedDB.reqToPromise(\r\n      indexName\r\n        ? this.getTable(table).index(indexName).getKey(key)\r\n        : this.getTable(table).getKey(key)\r\n    )\r\n  }\r\n\r\n  async findKeys(\r\n    table: string, key: IDBKey, indexName?: string\r\n  ): Promise<IDBValidKey[]> {\r\n    if (!indexName) return await this.has(table, key) ?\r\n      [key as IDBValidKey] : []\r\n    return IndexedDB.reqToPromise(\r\n      this.getTable(table).index(indexName).getAllKeys(key)\r\n    )\r\n  }\r\n\r\n  async del(table: string, key: IDBKey, indexName?: string) {\r\n    let _key = await this.findKey(table, key, indexName)\r\n    if (_key === undefined) return\r\n    await IndexedDB.reqToPromise(this.getTable(table).delete(_key))\r\n    return _key\r\n  }\r\n\r\n  static dataToKey(table: IDBObjectStore, data: any): IDBKey {\r\n    let { keyPath } = table\r\n    if (typeof keyPath === 'string') return data[keyPath]\r\n    return keyPath.map(value => data[value])\r\n  }\r\n\r\n  async has(table: string, key: IDBKey, indexName?: string) {\r\n    return (await this.findKey(table, key, indexName)) !== undefined\r\n  }\r\n\r\n  async get(table: string, key: IDBKey, indexName?: string) {\r\n    let _key = await this.findKey(table, key, indexName)\r\n    return _key &&\r\n      await IndexedDB.reqToPromise(this.getTable(table).get(_key))\r\n  }\r\n\r\n  async* items(\r\n    table: IDBObjectStore | string\r\n  ): AsyncGenerator<[any, IDBKey, number, number]> {\r\n    if (typeof table === 'string') table = this.getTable(table)\r\n    let total = await IndexedDB.reqToPromise(table.count())\r\n    let req = table.openCursor()\r\n    let n = 0, cursor: IDBCursorWithValue | null\r\n    while (cursor = await IndexedDB.reqToPromise(req)) {\r\n      yield [cursor.value, cursor.key, n, total]\r\n      n += 1\r\n      cursor.continue()\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default IndexedDB","class IndexFile {\r\n  version = ''\r\n  versionName = ''\r\n  generatorName = 'HELPER'\r\n  splitBar = '-'.repeat(70)\r\n  lineSeparator = '\\n'\r\n  columnseparator = '\\t'\r\n  datas: string[][] = []\r\n\r\n  constructor(text?: string) {\r\n    if (text) this.text = text\r\n  }\r\n\r\n  get dataText(): string {\r\n    return this.datas.map(\r\n      data => data.join(this.columnseparator)\r\n    ).join(this.lineSeparator)\r\n  }\r\n\r\n  set dataText(text: string) {\r\n    this.parseData(text.split(this.lineSeparator))\r\n  }\r\n\r\n  parseData(lines: string[]) {\r\n    this.cleanData()\r\n    this.datas = lines.map(line => line.split(this.columnseparator))\r\n  }\r\n\r\n  get headerText(): string {\r\n    return [\r\n      '',\r\n      `THIS FILE IS GENERATED BY ${this.generatorName}, DON'T CHANGE IT MANUALLY!`,\r\n      '',\r\n      [this.version, this.versionName].join(this.columnseparator)\r\n    ].join(this.lineSeparator)\r\n  }\r\n\r\n  set headerText(text: string) {\r\n    this.parseHeader(text.split(this.lineSeparator))\r\n  }\r\n\r\n  parseHeader(lines: string[]) {\r\n    this.generatorName =\r\n      lines[1].substring(26, lines[1].length - 27);\r\n    [this.version, this.versionName] =\r\n      lines[3].split(this.columnseparator)\r\n    if (this.headerText !== lines.join(this.lineSeparator))\r\n      throw 'Error IndexFile Header!'\r\n  }\r\n\r\n  get text(): string {\r\n    let result = this.headerText + this.lineSeparator + this.splitBar\r\n    if (this.datas.length)\r\n      result += this.lineSeparator + this.dataText\r\n    return result + this.lineSeparator\r\n  }\r\n\r\n  set text(text: string) {\r\n    this.parseText(\r\n      text.replace(/\\r\\n/g, '\\n').split(this.lineSeparator)\r\n    )\r\n  }\r\n\r\n  parseText(lines: string[]) {\r\n    this.parseHeader(lines.slice(0, 4))\r\n    this.parseData(lines.slice(5, -1))\r\n  }\r\n\r\n  addData(...columns: string[]) {\r\n    this.datas.push(columns)\r\n  }\r\n\r\n  cleanData() {\r\n    this.datas = []\r\n  }\r\n\r\n}\r\n\r\nexport default IndexFile","class HashInfo<T = string> {\r\n  hash: string\r\n  info: T\r\n  constructor(_hash: string, _info: T) {\r\n    this.hash = _hash\r\n    this.info = _info\r\n  }\r\n\r\n  // When the T is object, maybe need overwrite this func\r\n  infoEqualFunc(info: T): boolean {\r\n    return this.info === info\r\n  }\r\n\r\n  infoEqual(another: HashInfo<T>): boolean {\r\n    return this.infoEqualFunc(another.info)\r\n  }\r\n\r\n  static toMap<T>(array: Iterable<HashInfo<T>>): Map<string, T> {\r\n    let map = new Map<string, T>()\r\n    for (let item of array) map.set(item.hash, item.info)\r\n    return map\r\n  }\r\n\r\n  static fromMap<T>(map: Map<string, T>): HashInfo<T>[] {\r\n    let arr: HashInfo<T>[] = []\r\n    for (let [hash, info] of map) arr.push(new HashInfo(hash, info))\r\n    return arr\r\n  }\r\n}\r\n\r\nexport default HashInfo","enum HashInfoDiffType {\r\n  Add,\r\n  Delete,\r\n  ReHash,       // Same Info, Diff Hash\r\n  ReInfo,       // Same Hash, Diff Info\r\n}\r\n\r\nexport default HashInfoDiffType","type WithChildren<T> = T & { children?: WithChildren<T>[] }\r\n\r\nexport function removeUndefProp<T>(obj: T): T {\r\n  for (let key of Object.keys(obj))\r\n    if ((obj as any)[key] === undefined)\r\n      delete (obj as any)[key]\r\n  return obj\r\n}\r\n\r\nexport function assignWhenExist<T1, T2>(to: T1, from: T2): T1 & T2 {\r\n  return Object.assign(to, removeUndefProp(from))\r\n}\r\n\r\nexport function eachChild<T>(\r\n  func: (\r\n    item: WithChildren<T>,\r\n    parent?: { children?: WithChildren<T>[] }\r\n  ) => void,\r\n  items: WithChildren<T>[],\r\n  parent?: { children?: WithChildren<T>[] }\r\n) {\r\n  for (let item of items) {\r\n    if (item.children) eachChild(func, item.children, item)\r\n    func(item, parent)\r\n  }\r\n}\r\n\r\nexport function mapFindIndex<T_KEY, T>(\r\n  _map: Map<T_KEY, T>,\r\n  _value: T,\r\n  _equalFunc = (a: T, b: T) => a === b\r\n): T_KEY | undefined {\r\n  for (let [key, value] of _map)\r\n    if (_equalFunc(value, _value)) return key\r\n}\r\n\r\nexport function mapFind<T>(\r\n  _map: Map<unknown, T>,\r\n  _value: T,\r\n  _equalFunc = (a: T, b: T) => a === b\r\n): T | undefined {\r\n  for (let [, value] of _map)\r\n    if (_equalFunc(value, _value)) return value\r\n}\r\n","import HashInfo from './HashInfo'\r\nimport HashInfoDiffType from './HashInfoDiffType'\r\nimport { mapFind } from './ObjectHelper'\r\n\r\nclass HashInfoDiff<T = string> {\r\n  left?: HashInfo<T>\r\n  right?: HashInfo<T>\r\n  type: HashInfoDiffType\r\n  constructor(\r\n    _type: HashInfoDiffType,\r\n    _left?: HashInfo<T>,\r\n    _right?: HashInfo<T>\r\n  ) {\r\n    this.left = _left\r\n    this.right = _right\r\n    this.type = _type\r\n  }\r\n\r\n  static toMap<T>(_arr: HashInfo<T>[]) {\r\n    return new Map(_arr.map(item => [item.hash, item]))\r\n  }\r\n\r\n  static compare<T>(\r\n    _left: HashInfo<T>[],\r\n    _right: HashInfo<T>[],\r\n  ): HashInfoDiff<T>[] {\r\n    let diffs: HashInfoDiff<T>[] = []\r\n    let map_left = HashInfoDiff.toMap(_left)\r\n    let map_right = HashInfoDiff.toMap(_right)\r\n    let reInfos: HashInfoDiff<T>[] = []\r\n    for (let [right_hash, right_item] of map_right) {\r\n      let left_item = map_left.get(right_hash)\r\n      if (left_item) {\r\n        // ReInfo Item\r\n        if (!left_item.infoEqual(right_item))\r\n          reInfos.push(new HashInfoDiff(\r\n            HashInfoDiffType.ReInfo, left_item, right_item\r\n          ))\r\n        // UnChanged Item\r\n        // else {}\r\n        map_left.delete(right_hash)\r\n        map_right.delete(right_hash)\r\n      }\r\n    }\r\n    for (let [, left_item] of map_left) {\r\n      let right_item = mapFind(map_right, left_item,\r\n        (a, b) => a.infoEqual(b)\r\n      )\r\n      if (right_item) {                  // ReHash Item\r\n        diffs.push(new HashInfoDiff(\r\n          HashInfoDiffType.ReHash, left_item, right_item\r\n        ))\r\n        map_right.delete(right_item.hash)\r\n      } else                            // Delete Item\r\n        diffs.push(new HashInfoDiff(\r\n          HashInfoDiffType.Delete, left_item\r\n        ))\r\n    }\r\n    for (let [, right_item] of map_right) // Add Item\r\n      diffs.push(new HashInfoDiff(\r\n        HashInfoDiffType.Add, undefined, right_item\r\n      ))\r\n    return diffs.concat(reInfos)\r\n  }\r\n\r\n}\r\n\r\nexport default HashInfoDiff","class IDBFSMergeStep {\r\n  hashDelete: string[] = []\r\n  hashAdd: {\r\n    hash: string,\r\n    url: string\r\n  }[] = []\r\n  fileDelete: string[] = []\r\n  fileAdd: {\r\n    hash: string,\r\n    url: string\r\n  }[] = []\r\n  get length() {\r\n    return this.hashDelete.length\r\n      + this.hashAdd.length\r\n      + this.fileDelete.length\r\n      + this.fileAdd.length\r\n  }\r\n}\r\n\r\nexport default IDBFSMergeStep","import HashInfo from './HashInfo'\r\nimport IndexFile from './IndexFile'\r\nimport HashInfoDiff from './HashInfoDiff'\r\nimport IDBFSMergeStep from './IDBFSMergeStep'\r\nimport HashInfoDiffType from './HashInfoDiffType'\r\n\r\nclass IDBFSFile extends HashInfo<string[]> {\r\n\r\n  constructor(hash: string, ...names: string[]) {\r\n    super(hash, names)\r\n  }\r\n\r\n  infoEqualFunc(info: string[]): boolean {\r\n    if (this.info.length !== info.length) return false\r\n    this.info.sort()\r\n    info.sort()\r\n    for (let i = 0; i < info.length; i += 1)\r\n      if (this.info[i] !== info[i]) return false\r\n    return true\r\n  }\r\n\r\n  static fromIndex(indexFile: IndexFile): IDBFSFile[] {\r\n    let map = new Map<string, string[]>()\r\n    for (let [hash, name] of indexFile.datas) {\r\n      if (!map.has(hash)) map.set(hash, [])\r\n      map.get(hash)!.push(name)\r\n    }\r\n    let res: IDBFSFile[] = []\r\n    for (let [hash, names] of map.entries())\r\n      res.push(new IDBFSFile(hash, ...names))\r\n    return res\r\n  }\r\n\r\n  static calcMergeSteps(\r\n    from: IDBFSFile[], to: IDBFSFile[]\r\n  ): IDBFSMergeStep {\r\n    let diffs = HashInfoDiff.compare(from, to)\r\n    let steps = new IDBFSMergeStep()\r\n    let add = (diff: HashInfoDiff<string[]>) => {\r\n      let { hash, info } = diff.right!\r\n      steps.hashAdd.push({ hash, url: info[0] })\r\n      steps.fileAdd.push(...info.map(url => ({ hash, url })))\r\n    }\r\n    let del = (diff: HashInfoDiff<string[]>) => {\r\n      let { hash, info } = diff.left!\r\n      steps.hashDelete.push(hash)\r\n      steps.fileDelete.push(...info)\r\n    }\r\n    for (let diff of diffs)\r\n      switch (diff.type) {\r\n        case HashInfoDiffType.Add:\r\n          add(diff)\r\n          break\r\n        case HashInfoDiffType.Delete:\r\n          del(diff)\r\n          break\r\n        case HashInfoDiffType.ReInfo:\r\n          let setLeft = new Set(diff.left!.info)\r\n          let setRight = new Set(diff.right!.info)\r\n          for (let item of setLeft) if (setRight.has(item))\r\n            setLeft.delete(item), setRight.delete(item)\r\n          steps.fileDelete.push(...setLeft)\r\n          let { hash } = diff.left!\r\n          for (let url of setRight) steps.fileAdd.push({ hash, url })\r\n          break\r\n        case HashInfoDiffType.ReHash:\r\n          del(diff)\r\n          add(diff)\r\n      }\r\n    return steps\r\n  }\r\n\r\n}\r\n\r\nexport default IDBFSFile","class ProcessEvent<T> extends ProgressEvent {\n\n  static msgs = new Map<string, (ev: ProcessEvent<any>) => string>([\n    [\n      'IDBFS.Merge', (\n        ev: ProcessEvent<{ action: string, content: string }>\n      ) => `${ev.info.action}${ev.info.content}`\n    ],\n    [\n      'Loader.IndexGetting',\n      () => ''\n    ],\n    [\n      'Loader.IndexFetchError',\n      ev => `${ev.info}`\n    ],\n    [\n      'Loader.IndexLocal', (\n        ev: ProcessEvent<{ versionName: string }>\n      ) => `${ev.info.versionName}`\n    ],\n    [\n      'Loader.IndexNone',\n      () => ''\n    ],\n    [\n      'Loader.IndexDiffsCalcing',\n      () => ''\n    ],\n    [\n      'Loader.IndexNewest', (\n        ev: ProcessEvent<{ versionName: string }>\n      ) => `${ev.info.versionName}`\n    ],\n    [\n      'Loader.ScenesReging',\n      () => ''\n    ],\n    [\n      'Loader.ScenesReged',\n      () => ''\n    ],\n    [\n      'Loader.ModelsLoading',\n      () => ''\n    ],\n    [\n      'Loader.ScenesLoading',\n      () => ''\n    ],\n    [\n      'Loader.ScenesLoaded',\n      () => ''\n    ],\n    [\n      'Loader.ArIniting',\n      () => 'AR'\n    ],\n    [\n      'Loader.ArInited',\n      () => 'AR'\n    ],\n    [\n      'ArRender.ArStarting',\n      () => 'AR'\n    ],\n    [\n      'Loader.ArStarted',\n      () => 'AR'\n    ],\n  ])\n\n  info: T\n\n  constructor(\n    type: string,\n    info: T,\n    loaded = 0,\n    total = 1,\n    lengthComputable = true\n  ) {\n    super(type, { total, loaded, lengthComputable })\n    this.info = info\n    let m = ProcessEvent.msgs.get(type)\n    this.msgTemplete = m\n    if (m) this.msg = m(this)\n  }\n\n  msgTemplete?: (ev: ProcessEvent<T>) => string\n\n  msg = ''\n\n  static newError<T>(\n    type: string,\n    info: T,\n    loaded = 0,\n    total = 1\n  ) {\n    return new ProcessEvent(type, info, loaded, total, false)\n  }\n\n}\n\nexport default ProcessEvent","// IndexedDB File System\r\nimport IndexedDB from './IndexedDB'\r\nimport IndexFile from './IndexFile'\r\nimport IDBFSFile from './IDBFSFile'\r\nimport ProcessEvent from './ProcessEvent'\r\n\r\nclass IDBFS {\r\n  db?: IndexedDB\r\n  private _initing = false\r\n  private _version?: string\r\n  private _versionName?: string\r\n\r\n  blobUrlMap: Map<Blob, string> = new Map()\r\n  urlBlobMap: Map<string, Blob> = new Map()\r\n  files = new Set<string>()\r\n\r\n  static resServer = ''\r\n  static instance = new IDBFS()\r\n\r\n  constructor() {\r\n    this.init()\r\n  }\r\n\r\n  get initing() {\r\n    return this._initing\r\n  }\r\n\r\n  get version() {\r\n    return this._version || ''\r\n  }\r\n\r\n  get versionName() {\r\n    return this._versionName || ''\r\n  }\r\n\r\n  private setVersion(version: string, versionName: string) {\r\n    this._version = version\r\n    this._versionName = versionName\r\n  }\r\n\r\n  private async updateVersion(version: string, versionName: string) {\r\n    await this.db!.put('sets',\r\n      { set_id: 'version', version, versionName, }\r\n    )\r\n    this.setVersion(version, versionName)\r\n  }\r\n\r\n  waiter?: (() => void)[]\r\n\r\n  async init() {\r\n    if (this.db) return\r\n    if (this._initing) return new Promise<void>(resolve => {\r\n      if (!this.waiter) this.waiter = []\r\n      this.waiter.push(resolve)\r\n    })\r\n    this._initing = true\r\n    this.db = await IndexedDB.open('IDBFS', 1, function (req) {\r\n      IndexedDB.createFromTables(req.result, new Map([\r\n        ['caches',\r\n          { param: { keyPath: 'hash' } }\r\n        ],\r\n        ['files',\r\n          {\r\n            param: { keyPath: 'url' },\r\n            indexs: [['hashIndex', 'hash', { unique: false }]]\r\n          }\r\n        ],\r\n        ['sets',\r\n          { param: { keyPath: 'set_id' } }\r\n        ]\r\n      ]))\r\n    })\r\n    await this.updateFiles()\r\n    let ver = await this.db!.get('sets', 'version')\r\n    if (ver) this.setVersion(ver.version, ver.versionName)\r\n    if (this.waiter) this.waiter.forEach(resolve => resolve())\r\n    this._initing = false\r\n  }\r\n\r\n  get inited() {\r\n    return new Boolean(this.db).valueOf()\r\n  }\r\n\r\n  async updateFiles() {\r\n    this.files.clear()\r\n    let arr: string[] = []\r\n    for await (let [{ url }] of this.db!.items('files')) arr.push(url)\r\n    arr.sort().forEach(this.files.add, this.files)\r\n  }\r\n\r\n  static async fetchBlob(\r\n    input: RequestInfo,\r\n    init?: RequestInit | undefined\r\n  ) {\r\n    if (typeof input === 'string' && !input.startsWith('http'))\r\n      input = IDBFS.resServer +\r\n        (input.startsWith('/') ? input : '/' + input)\r\n    return (await fetch(input, init)).blob()\r\n  }\r\n\r\n  async regUrl(url: string, hash: string, overwrite?: boolean) {\r\n    if (overwrite) return this.db!.put('files', { url, hash })\r\n    return this.db!.add('files', { url, hash })\r\n  }\r\n\r\n  async regBlob(hash: string, blob: Blob) {\r\n    await this.init()\r\n    return this.db!.put('caches', { hash, blob })\r\n  }\r\n\r\n  async hashToBlob(hash: string): Promise<Blob | undefined> {\r\n    return (await this.db!.get('caches', hash)).blob\r\n  }\r\n\r\n  async hashToUrl(hash: string): Promise<string[]> {\r\n    return this.db!.findKeys('files', hash, 'hashIndex') as any\r\n  }\r\n\r\n  async urlToHash(url: string): Promise<string | undefined> {\r\n    return (await this.db!.get('files', url)).hash\r\n  }\r\n\r\n  async urlToBlob(url: string): Promise<Blob | undefined> {\r\n    let hash = await this.urlToHash(url)\r\n    if (hash) return this.hashToBlob(hash)\r\n  }\r\n\r\n  async urlToBlobUrl(url: string): Promise<string | undefined> {\r\n    let blob = await this.urlToBlob(url)\r\n    return blob && this.blobUrl(blob)\r\n  }\r\n\r\n  blobUrl(blob: Blob): string {\r\n    let url = this.blobUrlMap.get(blob)\r\n    if (!url) {\r\n      url = URL.createObjectURL(blob)\r\n      this.blobUrlMap.set(blob, url)\r\n      this.urlBlobMap.set(url, blob)\r\n    }\r\n    return url\r\n  }\r\n\r\n  blobUrlToBlob(url: string) {\r\n    return this.urlBlobMap.get(url)\r\n  }\r\n\r\n  async hasUrl(url: string): Promise<boolean> {\r\n    return this.db!.has('files', url)\r\n  }\r\n\r\n  async delHash(hash: string, tryClean?: boolean) {\r\n    await this.db!.del('caches', hash)\r\n    if (tryClean)\r\n      for (let url of await this.hashToUrl(hash))\r\n        await this.delUrl(url)\r\n  }\r\n\r\n  async delUrl(url: string, tryClean?: boolean) {\r\n    let hash: string | undefined\r\n    if (tryClean) hash = await this.urlToHash(url)\r\n    await this.db!.del('files', url)\r\n    if (hash && !await this.db!.has('files', hash, 'hashIndex'))\r\n      await this.delHash(hash)\r\n  }\r\n\r\n  async rename(url: string, newUrl: string, overwrite = false) {\r\n    let hash = await this.urlToHash(url)\r\n    if (!hash) throw `Can't find url: ${hash}`\r\n    await this.regUrl(newUrl, hash, overwrite)\r\n    await this.delUrl(url)\r\n  }\r\n\r\n  async cachedIndex() {\r\n    let cached = new IndexFile()\r\n    cached.version = this.version\r\n    cached.versionName = this.versionName\r\n    for await (let [{ hash, url }] of this.db!.items('files'))\r\n      cached.addData(hash, url)\r\n    return cached\r\n  }\r\n\r\n  async calcDiffs(indexFile: IndexFile) {\r\n    if (this.version === indexFile.version) return\r\n    return IDBFSFile.calcMergeSteps(\r\n      IDBFSFile.fromIndex(await this.cachedIndex()),\r\n      IDBFSFile.fromIndex(indexFile)\r\n    )\r\n  }\r\n\r\n  find(rule: RegExp) {\r\n    return [...this.files].filter(url => rule.test(url))\r\n  }\r\n\r\n  async mergeTo(\r\n    indexFile: IndexFile,\r\n    processCB?: processCB<{ action: string, content: string }>\r\n  ) {\r\n    let diffs = await this.calcDiffs(indexFile)\r\n    if (!diffs) return\r\n    let n = 0, total = diffs.length\r\n    let proc = (action: string, content: string) =>\r\n      processCB && processCB(new ProcessEvent(\r\n        'IDBFS.Merge', { action, content }, n += 1, total\r\n      ))\r\n    for (let { hash, url } of diffs.hashAdd) {\r\n      await proc('', url)\r\n      await this.regBlob(hash, await IDBFS.fetchBlob(url))\r\n    }\r\n    for (let url of diffs.fileDelete) {\r\n      await proc('', url)\r\n      await this.delUrl(url)\r\n    }\r\n    for (let { hash, url } of diffs.fileAdd) {\r\n      await proc('', url)\r\n      await this.regUrl(url, hash)\r\n    }\r\n    for (let hash of diffs.hashDelete) {\r\n      await proc('', hash)\r\n      await this.delHash(hash)\r\n    }\r\n    await this.updateFiles()\r\n    let { version, versionName } = indexFile\r\n    await this.updateVersion(version, versionName)\r\n  }\r\n\r\n}\r\n\r\nexport default IDBFS","import ResourceMgr from './ResourceMgr'\r\nimport IDBFS from './IDBFS'\r\n\r\nclass FileMgr extends ResourceMgr<string, Blob> {\r\n  static fs = IDBFS.instance\r\n\r\n  async make(desc: string): Promise<Blob | undefined> {\r\n    let inst = this.get(desc)\r\n    if (inst) return inst\r\n    let blob = await FileMgr.fs.urlToBlob(desc)\r\n    if (!blob) throw `Can't find file '${desc}' in FS!`\r\n    this.set(desc, blob)\r\n  }\r\n\r\n  getBlobUrl(url: string) {\r\n    let blob = this.get(url)\r\n    return blob && FileMgr.fs.blobUrl(blob)\r\n  }\r\n\r\n  static instance = new FileMgr()\r\n}\r\n\r\nexport default FileMgr","import ResourceMgr from './ResourceMgr'\r\n\r\nimport FileMgr from './FileMgr'\r\n\r\nclass MarkerMgr extends ResourceMgr<string, marker> {\r\n  fileMgr = FileMgr.instance\r\n\r\n  regBasicRes(...descs: string[]) {\r\n    let _descs = descs.length ? descs : this.unready\r\n    for (let desc of _descs) {\r\n      this.fileMgr.reg(`markers/${desc}.iset`)\r\n      this.fileMgr.reg(`markers/${desc}.fset`)\r\n      this.fileMgr.reg(`markers/${desc}.fset3`)\r\n    }\r\n  }\r\n\r\n  async initBasicRes() {\r\n    await this.fileMgr.init()\r\n  }\r\n\r\n  async make(desc: string, basicReadied?: boolean) {\r\n    let inst = this.get(desc)\r\n    if (inst) return inst\r\n    if (!basicReadied) {\r\n      this.regBasicRes(desc)\r\n      await this.initBasicRes()\r\n    }\r\n    let iset = this.fileMgr.getBlobUrl(`markers/${desc}.iset`)\r\n    let fset = this.fileMgr.getBlobUrl(`markers/${desc}.fset`)\r\n    let fset3 = this.fileMgr.getBlobUrl(`markers/${desc}.fset3`)\r\n    if (!iset || !fset || !fset3)\r\n      throw `Error Marker: ${JSON.stringify(desc)}`\r\n    let marker = { iset, fset, fset3 }\r\n    this.set(desc, marker)\r\n    return marker\r\n  }\r\n\r\n  static instance = new MarkerMgr()\r\n}\r\n\r\nexport default MarkerMgr","import { Vector3 } from 'three'\r\n\r\nexport function toRad(deg: number) {\r\n  return deg / 180 * Math.PI\r\n}\r\n\r\nexport function toRads(...degs: number[]) {\r\n  return degs.map(deg => toRad(deg))\r\n}\r\n\r\nexport function toDegree(rad: number) {\r\n  return rad * 180 / Math.PI\r\n}\r\n\r\nexport function toDegrees(...rads: number[]) {\r\n  return rads.map(rad => toDegree(rad))\r\n}\r\n\r\nexport function lerp(a: number, b: number, v: number) {\r\n  return (b - a) * v + a\r\n}\r\n\r\nexport function rlerp(a: number, b: number, v: number) {\r\n  return (v - a) / (b - a)\r\n}\r\n\r\nexport function circleOut(v: number) {\r\n  if (v < 0) v = 0\r\n  return Math.sqrt(1 - Math.pow(v - 1, 2))\r\n}\r\n\r\nexport function powerOut(v: number, pow = 2) {\r\n  if (v > 1) return 1\r\n  return 1 - Math.pow((1 - v), pow)\r\n}\r\n\r\nexport function stick(value: number, to = 0, ease = 50) {\r\n  let delta = value - to\r\n  return Math.sign(delta) * Math.log1p(Math.abs(delta) / ease) * ease + to\r\n}\r\n\r\nexport function distance(x1: number, y1: number, x2: number, y2: number) {\r\n  let dx = x2 - x1\r\n  let dy = y2 - y1\r\n  return Math.sqrt(dx * dx + dy * dy)\r\n}\r\n\r\nexport function toZero(value: number, delta: number) {\r\n  let result\r\n  if (value > 0) {\r\n    result = value - delta\r\n    return result < 0 ? 0 : result\r\n  } else {\r\n    result = value + delta\r\n    return result > 0 ? 0 : result\r\n  }\r\n}\r\n\r\nexport function newEaseFunc(k: number = 0.2) {\r\n  let b = k * k / (1 - k - k)\r\n  if (b === Infinity) return function (x: number) { return x }\r\n  let a = b + b * b\r\n  return function (x: number) {\r\n    return 1 + b - a / (x + b)\r\n  }\r\n}\r\n\r\nexport function toVec3(xyz: xyz) {\r\n  return new Vector3(...xyz)\r\n}\r\n\r\nexport function toXYZ(vec3: Vector3): xyz {\r\n  return [vec3.x, vec3.y, vec3.z]\r\n}","import { lerp, rlerp } from './MathHelper'\r\n\r\nclass NumberRange {\r\n  max: number\r\n  min: number\r\n\r\n  get distance() {\r\n    return this.max - this.min\r\n  }\r\n\r\n  constructor(min = 0, max = 1) {\r\n    this.min = min\r\n    this.max = max\r\n  }\r\n\r\n  clamp(n: number) {\r\n    return n < this.min ? this.min : (\r\n      n > this.max ? this.max : n\r\n    )\r\n  }\r\n\r\n  contain(n: number) {\r\n    return n >= this.min && n <= this.max\r\n  }\r\n\r\n  lerp(n: number) {\r\n    return lerp(this.min, this.max, n)\r\n  }\r\n\r\n  rlerp(n: number) {\r\n    return rlerp(this.min, this.max, n)\r\n  }\r\n}\r\n\r\nexport default NumberRange","import NumberRange from './NumberRange'\r\n\r\nclass RangeDesc extends NumberRange {\r\n  group = 10\r\n  initValue = 0\r\n  step = 1\r\n  unit = ''\r\n\r\n  fixValue(val: number): number {\r\n    let v = Math.round(\r\n      (val - this.min) / this.step\r\n    ) * this.step + this.min\r\n    return this.clamp(v)\r\n  }\r\n\r\n  static create(params?: {\r\n    group?: number,\r\n    initValue?: number,\r\n    min?: number,\r\n    max?: number,\r\n    step?: number,\r\n    unit?: string,\r\n  }) {\r\n    let result = new RangeDesc()\r\n    Object.assign(result, params)\r\n    return result\r\n  }\r\n}\r\n\r\nexport default RangeDesc","import { Scene, Camera } from 'three'\r\nimport { VueConstructor } from 'vue'\r\n\r\nimport ArSceneType from './ArSceneType'\r\nimport MarkerMgr from './MarkerMgr'\r\n\r\nimport { assignWhenExist } from './ObjectHelper'\r\nimport Vue from 'vue'\r\nimport RangeDesc from './RangeDesc'\r\n\r\nclass ArScene extends Scene {\r\n  sceneID = 'none'\r\n  title = 'AR'\r\n  sceneType = ArSceneType.none\r\n  desc?: VueConstructor\r\n\r\n  camera = new Camera()\r\n  marker?: marker\r\n  onTickFuncs: tickFunc[] = []\r\n\r\n  params: arSceneParam[] = []\r\n\r\n  paramsValue = new Vue({\r\n    data: {\r\n      values: {} as { [key: string]: any }\r\n    }\r\n  })\r\n\r\n  constructor(marker?: marker) {\r\n    super()\r\n    this.visible = false\r\n    this.marker = marker\r\n    this.add(this.camera)\r\n    this.camera.visible = false\r\n  }\r\n\r\n  setWithDesc(\r\n    basicDesc: basicSceneDesc,\r\n    markerMgr = MarkerMgr.instance\r\n  ) {\r\n    this.name = basicDesc.sceneID\r\n    if (basicDesc.markerUrl)\r\n      this.marker = markerMgr.get(basicDesc.markerUrl)\r\n    let { sceneID, title, params, desc, onTickFuncs } = basicDesc\r\n    if (params)\r\n      for (let param of params)\r\n        Vue.set(this.paramsValue.values, param.name,\r\n          param.desc instanceof RangeDesc\r\n            ? param.desc.initValue\r\n            : param.desc.cases.get(param.desc.default)\r\n        )\r\n    assignWhenExist(this, { sceneID, title, params, desc, onTickFuncs })\r\n  }\r\n\r\n  getZoom() {\r\n    return 1\r\n  }\r\n\r\n  static fromDesc(desc: basicSceneDesc): ArScene {\r\n    let scene = new ArScene()\r\n    scene.setWithDesc(desc)\r\n    return scene\r\n  }\r\n\r\n}\r\nexport default ArScene","import ArScene from './ArScene'\r\nimport ArSceneType from './ArSceneType'\r\nimport MarkerMgr from './MarkerMgr'\r\n\r\nclass ArExpScene extends ArScene {\r\n\r\n  constructor(marker?: marker) {\r\n    super(marker)\r\n    this.add(this.camera)\r\n    this.sceneType = ArSceneType.exp\r\n  }\r\n\r\n  static fromDesc(\r\n    desc: expSceneDesc,\r\n    markerMgr = MarkerMgr.instance,\r\n  ): ArExpScene {\r\n    let scene = new ArExpScene()\r\n    scene.setWithDesc(desc, markerMgr)\r\n    return scene\r\n  }\r\n}\r\n\r\nexport default ArExpScene","import { Texture, TextureLoader } from 'three'\r\n\r\nimport ResourceMgr from './ResourceMgr'\r\n\r\nimport FileMgr from './FileMgr'\r\n\r\nclass TexMgr extends ResourceMgr<texDesc, Texture> {\r\n  fileMgr = FileMgr.instance\r\n\r\n  regBasicRes(...descs: texDesc[]) {\r\n    let _descs = descs.length ? descs : this.unready\r\n    for (let desc of _descs)\r\n      if (!(desc instanceof Texture))\r\n        this.fileMgr.reg(\r\n          typeof desc === 'string' ? desc : desc.url\r\n        )\r\n  }\r\n\r\n  async initBasicRes() {\r\n    await this.fileMgr.init()\r\n  }\r\n\r\n  async make(desc: texDesc, basicReadied?: boolean) {\r\n    let inst = this.get(desc)\r\n    if (inst) return inst\r\n    if (desc instanceof Texture) {\r\n      this.set(desc, desc)\r\n      return desc\r\n    }\r\n    let url = ''\r\n    let params: any\r\n    if (typeof desc === 'string') url = desc\r\n    else {\r\n      url = desc.url\r\n      params = desc.params\r\n    }\r\n    if (!url) throw `Empty Texture Url!`\r\n    if (!basicReadied) {\r\n      this.regBasicRes(url)\r\n      await this.initBasicRes()\r\n    }\r\n    let blob_url = this.fileMgr.getBlobUrl(url)\r\n    if (!blob_url) throw `Missed Tex File: ${url}`\r\n    let tex_loader = new TextureLoader()\r\n    return new Promise<Texture>((resolve, reject) =>\r\n      tex_loader.load(blob_url!, tex => {\r\n        if (params) Object.assign(tex, params)\r\n        this.set(desc, tex)\r\n        resolve(tex)\r\n      }, undefined, reject)\r\n    )\r\n  }\r\n\r\n  reg(desc: texDesc) {\r\n    if (desc instanceof Texture)\r\n      this.set(desc, desc)\r\n    else super.reg(desc)\r\n  }\r\n\r\n  static instance = new TexMgr()\r\n}\r\n\r\nexport default TexMgr","import { Material } from 'three'\r\n\r\nimport ResourceMgr from './ResourceMgr'\r\n\r\nimport TexMgr from './TexMgr'\r\n\r\nclass MatMgr extends ResourceMgr<matDesc, Material> {\r\n  texMgr = TexMgr.instance\r\n\r\n  regBasicRes(...descs: matDesc[]) {\r\n    let _descs = descs.length ? descs : this.unready\r\n    for (let desc of _descs) {\r\n      if (desc instanceof Material) continue\r\n      if (!desc.matClass && !desc.init)\r\n        throw `Error MatDesc: ${JSON.stringify(desc)}`\r\n      if (desc.params)\r\n        for (let prop of Object.getOwnPropertyNames(desc.params))\r\n          if (prop === 'map' || prop.endsWith('Map'))\r\n            this.texMgr.reg(desc.params[prop] as texDesc)\r\n    }\r\n  }\r\n\r\n  async initBasicRes() {\r\n    await this.texMgr.init()\r\n  }\r\n\r\n  async make(desc: matDesc, basicReadied?: boolean) {\r\n    let inst = this.get(desc)\r\n    if (inst) return inst\r\n    if (desc instanceof Material) {\r\n      this.set(desc, desc)\r\n      return desc\r\n    }\r\n    if (!basicReadied) {\r\n      this.regBasicRes(desc)\r\n      await this.initBasicRes()\r\n    }\r\n    let params: any = {}\r\n    if (desc.params)\r\n      for (let prop of Object.getOwnPropertyNames(desc.params))\r\n        if (prop === 'map' || prop.endsWith('Map'))\r\n          params[prop] = this.texMgr.get(desc.params[prop])\r\n        else params[prop] = desc.params[prop]\r\n    let mat: Material\r\n    if (desc.matClass) mat = new (<any>desc.matClass)(params)\r\n    else if (desc.init) mat = desc.init(params)\r\n    else throw `Error MatDesc: ${JSON.stringify(desc)}`\r\n    this.set(desc, mat)\r\n    return mat\r\n  }\r\n\r\n  reg(desc: matDesc) {\r\n    if (desc instanceof Material)\r\n      this.set(desc, desc)\r\n    else super.reg(desc)\r\n  }\r\n\r\n  static instance = new MatMgr()\r\n}\r\n\r\nexport default MatMgr","import { Object3D, Material, Mesh, Scene, Group } from 'three'\r\n\r\nimport { GLTFLoader, GLTF } from 'three/examples/jsm/loaders/GLTFLoader'\r\n\r\nimport MatMgr from './MatMgr'\r\nimport ModelMgr from './ModelMgr'\r\nimport { toRads } from './MathHelper'\r\n\r\nimport ProcessEvent from './ProcessEvent'\r\n\r\nexport function meshesFromDescs(\r\n  descs: modelItemDesc[],\r\n  parent?: Object3D,\r\n  overrideMat?: Material,\r\n  modelMgr = ModelMgr.instance,\r\n  matMgr = MatMgr.instance,\r\n) {\r\n  return descs.map(desc => meshFromDesc(\r\n    desc, parent, overrideMat, modelMgr, matMgr\r\n  ))\r\n}\r\n\r\nexport function meshFromDesc(\r\n  desc: modelItemDesc,\r\n  parent?: Scene | Object3D,\r\n  overrideMat?: Material,\r\n  modelMgr = ModelMgr.instance,\r\n  matMgr = MatMgr.instance,\r\n): Mesh {\r\n  let model = modelMgr.get(desc.model)\r\n  let mat = desc.mat && matMgr.get(desc.mat)\r\n  let mesh = new Mesh(model, overrideMat || mat)\r\n  if (mat) mesh.userData['_mat'] = mat\r\n  if (parent) parent.add(mesh)\r\n  if (desc.name) mesh.name = desc.name\r\n  if (desc.position) mesh.position.set(...desc.position)\r\n  if (desc.rotate) mesh.rotation.set(...<xyz>toRads(...desc.rotate))\r\n  if (desc.scale) mesh.scale.set(...desc.scale)\r\n  if (desc.children) meshesFromDescs(\r\n    desc.children, mesh, overrideMat, modelMgr, matMgr\r\n  )\r\n  mesh.castShadow = true\r\n  mesh.receiveShadow = true\r\n  return mesh\r\n}\r\n\r\nexport function isMesh(obj: Object3D): obj is Mesh {\r\n  return obj.type === 'Mesh'\r\n}\r\n\r\nexport function mapModels(\r\n  obj: Object3D,\r\n  to?: Map<any, Model>,\r\n  cleanMat = true,\r\n) {\r\n  let result = to || new Map<string, Model>()\r\n  obj.traverse(child => {\r\n    if (!isMesh(child)) return\r\n    result.set(child.name, child.geometry)\r\n    if (!cleanMat || !child.material) return\r\n    if (Array.isArray(child.material))\r\n      for (let mat of child.material) mat.dispose()\r\n    else child.material.dispose()\r\n  })\r\n  return result\r\n}\r\n\r\nexport async function importGLTF(\r\n  url: string, onProgress?: processCB<any>\r\n) {\r\n  let cb = onProgress && ((ev: ProgressEvent) => onProgress(\r\n    new ProcessEvent('GLTFLoading', ev, ev.loaded, ev.total)\r\n  ))\r\n  return new Promise<GLTF>((resolve, reject) =>\r\n    new GLTFLoader().load(url, resolve, cb, reject)\r\n  )\r\n}\r\n","import { Geometry, BufferGeometry, Mesh } from 'three'\r\n\r\nimport ResourceMgr from './ResourceMgr'\r\n\r\nimport FileMgr from './FileMgr'\r\nimport { mapModels, importGLTF } from './ThreeJSHelper'\r\n\r\nfunction isUrl(desc: modelSourceDesc): desc is { url: string } {\r\n  return (desc as any).url\r\n}\r\n\r\nclass ModelMgr\r\n  extends ResourceMgr<modelSourceDesc, Model, modelDesc>\r\n{\r\n  fileMgr = FileMgr.instance\r\n\r\n  regBasicRes(...descs: modelSourceDesc[]) {\r\n    let _descs = descs.length ? descs : this.unready\r\n    for (let desc of _descs)\r\n      if (isUrl(desc))\r\n        this.fileMgr.reg(desc.url)\r\n  }\r\n\r\n  async initBasicRes() {\r\n    await this.fileMgr.init()\r\n  }\r\n\r\n  async make(desc: modelSourceDesc, basicReadied?: boolean) {\r\n    if (typeof desc === 'string') return this.get(desc)\r\n    if (\r\n      desc instanceof Geometry ||\r\n      desc instanceof BufferGeometry\r\n    ) {\r\n      this.set(desc, desc)\r\n      return desc\r\n    }\r\n    if (!isUrl(desc)) {\r\n      this.set(desc.name, desc.model)\r\n      return desc.model\r\n    }\r\n    if (!basicReadied) {\r\n      this.regBasicRes(desc)\r\n      await this.initBasicRes()\r\n    }\r\n    let blob_url = this.fileMgr.getBlobUrl(desc.url)\r\n    if (!blob_url) throw `Missed GLTF File: ${desc.url}`\r\n    let gltf = await importGLTF(blob_url)\r\n    console.log(gltf)\r\n    mapModels(gltf.scene, this)\r\n  }\r\n\r\n  reg(desc: modelSourceDesc) {\r\n    if (\r\n      desc instanceof Geometry ||\r\n      desc instanceof BufferGeometry\r\n    ) this.set(desc, desc)\r\n    else super.reg(desc)\r\n  }\r\n\r\n  static instance = new ModelMgr()\r\n\r\n}\r\n\r\nexport default ModelMgr","import NumberRange from './NumberRange'\r\nimport RangeDesc from './RangeDesc'\r\n\r\nimport { circleOut, toRad } from './MathHelper'\r\nimport { Vector3 } from 'three'\r\n\r\nclass OrbitValue {\r\n  rotateX = OrbitValue.ranges.rotateX.initValue\r\n  rotateY = OrbitValue.ranges.rotateY.initValue\r\n  zoom = OrbitValue.ranges.zoom.initValue\r\n\r\n  center = new Vector3(0, 0, 0)\r\n\r\n  farRange = new NumberRange(1, 10)\r\n\r\n  get isInitValue() {\r\n    return this.rotateX === OrbitValue.ranges.rotateX.initValue &&\r\n      this.rotateY === OrbitValue.ranges.rotateY.initValue &&\r\n      this.zoom === OrbitValue.ranges.zoom.initValue\r\n  }\r\n\r\n  get cameraPosition(): xyz {\r\n    let r = OrbitValue.zoomToR(this.farRange, this.zoom)\r\n    let y = r * Math.sin(toRad(this.rotateX))\r\n    let r1 = r * Math.cos(toRad(this.rotateX))\r\n    let x = r1 * Math.sin(toRad(this.rotateY))\r\n    let z = r1 * Math.cos(toRad(this.rotateY))\r\n    return [\r\n      x + this.center.x,\r\n      y + this.center.y,\r\n      z + this.center.z,\r\n    ]\r\n  }\r\n\r\n  reset() {\r\n    Object.assign(this, OrbitValue.initValue)\r\n  }\r\n\r\n  static zoomRange = new NumberRange(1, 10)\r\n\r\n  static zoomToR(farRange: NumberRange, zoom: number) {\r\n    return farRange.lerp(\r\n      1 - circleOut(OrbitValue.zoomRange.rlerp(zoom))\r\n    )\r\n  }\r\n\r\n  static ranges = {\r\n    rotateX: RangeDesc.create({\r\n      min: -90,\r\n      max: 90,\r\n      step: 1,\r\n      group: 5,\r\n      unit: \"\",\r\n      initValue: 30\r\n    }),\r\n    rotateY: RangeDesc.create({\r\n      min: -180,\r\n      max: 180,\r\n      step: 1,\r\n      group: 10,\r\n      unit: \"\",\r\n      initValue: 0\r\n    }),\r\n    zoom: RangeDesc.create({\r\n      min: 1,\r\n      max: 10,\r\n      step: 0.1,\r\n      group: 10,\r\n      unit: \"x\",\r\n      initValue: 1,\r\n    })\r\n  };\r\n\r\n  static get initValue() {\r\n    return {\r\n      rotateX: OrbitValue.ranges.rotateX.initValue,\r\n      rotateY: OrbitValue.ranges.rotateY.initValue,\r\n      zoom: OrbitValue.ranges.zoom.initValue,\r\n    }\r\n  }\r\n}\r\n\r\nexport default OrbitValue","import {\r\n  Light,\r\n  DirectionalLight,\r\n  CircleBufferGeometry,\r\n  Mesh,\r\n  ShadowMaterial,\r\n  MeshNormalMaterial,\r\n  MeshStandardMaterial,\r\n  HemisphereLight,\r\n  PointLight,\r\n  Group,\r\n  Vector3,\r\n} from 'three'\r\n\r\nimport ArScene from './ArScene'\r\n\r\nimport ArSceneType from './ArSceneType'\r\nimport MarkerMgr from './MarkerMgr'\r\nimport MatMgr from './MatMgr'\r\nimport TexMgr from './TexMgr'\r\nimport ModelMgr from './ModelMgr'\r\nimport OrbitValue from './OrbitValue'\r\n\r\nimport { assignWhenExist, eachChild } from './ObjectHelper'\r\nimport { toRad } from './MathHelper'\r\nimport { meshesFromDescs, meshFromDesc } from './ThreeJSHelper'\r\n\r\nclass ArModelScene extends ArScene {\r\n\r\n  size = 1\r\n\r\n  actions: arSceneAction[] = []\r\n\r\n  center = new Vector3(0, 0, 0)\r\n\r\n  get renderShadow() {\r\n    return this.shadowLight.castShadow\r\n  }\r\n\r\n  set renderShadow(value: boolean) {\r\n    this.shadowLight.castShadow = value\r\n  }\r\n\r\n  shipBody?: Mesh\r\n\r\n  lights = {\r\n    easy: [\r\n      new DirectionalLight(undefined, 0.5),\r\n      new DirectionalLight(undefined, 0.5),\r\n    ],\r\n    on: [\r\n      new DirectionalLight(undefined, 0.4),\r\n      new PointLight(undefined, 0.3),\r\n      new DirectionalLight(undefined, 0.2),\r\n      new PointLight(undefined, 0.1),\r\n    ],\r\n    off: []\r\n  }\r\n\r\n  basicLight = new HemisphereLight(0xa5e0ff, 0x6a5327, 1)\r\n  shadowLight = new DirectionalLight(0xffffff, 0.2)\r\n\r\n  groundMat = new ShadowMaterial({ opacity: 0.5 })\r\n\r\n  ground = new Mesh(\r\n    new CircleBufferGeometry(1000, 6),\r\n    this.groundMat\r\n  )\r\n\r\n  private _mat: matType = 'origin'\r\n\r\n  get mat() {\r\n    return this._mat\r\n  }\r\n\r\n  set mat(value: matType) {\r\n    this._mat = value\r\n    this.updateMat()\r\n  }\r\n\r\n  static normalMat = new MeshNormalMaterial()\r\n\r\n  static colorMat = new MeshStandardMaterial({\r\n    color: 0x87c7ee,\r\n    metalness: 0.2,\r\n    roughness: 0.55,\r\n  })\r\n\r\n  updateMat() {\r\n    if (this._mat !== 'origin') {\r\n      let mat = this._mat === 'color'\r\n        ? ArModelScene.colorMat\r\n        : ArModelScene.normalMat\r\n      eachChild(item => {\r\n        if (item instanceof Mesh)\r\n          item.material = mat\r\n      }, this.children)\r\n    } else\r\n      eachChild(item => {\r\n        if (item instanceof Mesh)\r\n          item.material =\r\n            item.userData['_mat'] || ArModelScene.colorMat\r\n      }, this.children)\r\n    this.ground.material = this.groundMat\r\n  }\r\n\r\n  private _light: lightType = 'on'\r\n\r\n  get light() {\r\n    return this._light\r\n  }\r\n\r\n  set light(value: lightType) {\r\n    this.remove(...this.lights[this._light])\r\n    this._light = value\r\n    this._updateLights()\r\n  }\r\n\r\n  private _orbitLights(lights: Light[], startAngle = 33.7) {\r\n    let orbit = new OrbitValue()\r\n    orbit.farRange.max = this.lightRadius\r\n    orbit.rotateX = 30\r\n    let n = lights.length\r\n    for (let i = 0; i < n; i += 1) {\r\n      orbit.rotateY = startAngle + i * 360 / n\r\n      lights[i].position.set(...orbit.cameraPosition)\r\n    }\r\n  }\r\n\r\n  private _updateEasyLights() {\r\n    this._orbitLights(this.lights.easy)\r\n  }\r\n\r\n  private _updateComplexLights() {\r\n    this._orbitLights(this.lights.on)\r\n  }\r\n\r\n  private _updateLights() {\r\n    this.add(...this.lights[this._light])\r\n    if (this._light === 'off')\r\n      this.basicLight.intensity = 1.5\r\n    else {\r\n      this.basicLight.intensity = 0.8\r\n      if (this._light === 'easy')\r\n        this._updateEasyLights()\r\n      else\r\n        this._updateComplexLights()\r\n    }\r\n  }\r\n\r\n  private _lightRadius = 2\r\n\r\n  get lightRadius(): number {\r\n    return this._lightRadius\r\n  }\r\n\r\n  set lightRadius(value: number) {\r\n    this._lightRadius = value\r\n    this._updateLights()\r\n  }\r\n\r\n  private _initLight() {\r\n    this.basicLight.name = '_basicLight'\r\n    this.add(this.basicLight)\r\n    this.shadowLight.name = '_shadowLight'\r\n    this.shadowLight.position.set(5, 10, 7.5)\r\n    this.shadowLight.shadow.mapSize.set(2048, 2048)\r\n    this.shadowLight.castShadow = true\r\n    this.add(this.shadowLight)\r\n    this.lights.easy.forEach(\r\n      (item, index) => item.name = `_easyLight${index}`\r\n    )\r\n    this.lights.on.forEach(\r\n      (item, index) => item.name = `_light${index}`\r\n    )\r\n    this._updateLights()\r\n  }\r\n\r\n  private _initGround() {\r\n    this.ground.name = \"_ground\"\r\n    this.ground.rotation.set(toRad(-90), 0, 0)\r\n    this.ground.receiveShadow = true\r\n    this.add(this.ground)\r\n  }\r\n\r\n  constructor(marker?: marker) {\r\n    super(marker)\r\n    this.sceneType = ArSceneType.model\r\n    this._initGround()\r\n    this._initLight()\r\n  }\r\n\r\n  static fromDesc(\r\n    desc: modelSceneDesc,\r\n    markerMgr = MarkerMgr.instance,\r\n    modelMgr = ModelMgr.instance,\r\n    matMgr = MatMgr.instance,\r\n    texMgr = TexMgr.instance,\r\n  ): ArModelScene {\r\n    let scene = new ArModelScene()\r\n    scene.setWithDesc(desc, markerMgr)\r\n    let overrideMat = {\r\n      origin: undefined,\r\n      color: ArModelScene.colorMat,\r\n      normal: ArModelScene.normalMat,\r\n    }[scene.mat]\r\n    let { size, actions } = desc\r\n    assignWhenExist(scene, { size, actions })\r\n    if (desc.center)\r\n      scene.center = new Vector3(...desc.center)\r\n    if (desc.env)\r\n      scene.environment = texMgr.get(desc.env) || null\r\n    if (desc.children) {\r\n      let content = new Group()\r\n      content.name = 'content'\r\n      meshesFromDescs(\r\n        desc.children, content, overrideMat, modelMgr, matMgr\r\n      )\r\n      scene.add(content)\r\n    }\r\n    if (desc.shipBody)\r\n      scene.shipBody = meshFromDesc(\r\n        desc.shipBody, undefined, overrideMat, modelMgr, matMgr\r\n      )\r\n    return scene\r\n  }\r\n}\r\n\r\nexport default ArModelScene","import './ar-js'\nimport { WebGLRenderer } from 'three'\nimport { EventEmitter } from \"events\"\nimport ArScene from './ArScene'\nimport ProcessEvent from './ProcessEvent'\nimport ArModelScene from './ArModelScene'\n\nclass ArRender extends WebGLRenderer {\n\n  private _arContext: THREEx.ArToolkitContext\n  private _arSource: THREEx.ArToolkitSource\n  private _clearNowScene = this._setNowScene.bind(this)\n  private _contextReady = false\n  private _looper_binded = this._looper.bind(this)\n  private _nowScene?: ArScene\n  private _onResize_binded = this._onResize.bind(this)\n  private _scenes: Set<ArScene> = new Set([])\n  private _timerNewNowScene?= 0\n\n  events = new EventEmitter()\n  funcs: tickFunc[] = []\n  hidden = false\n  lastTime = 0\n  nowSceneActrual?: ArScene\n  running = false\n\n  get nowScene() {\n    return this._nowScene\n  }\n\n  constructor(debugSource?: arSourceDesc) {\n    super({ antialias: true, alpha: true })\n    window.addEventListener(\n      'arjs-nft-loaded', ev => this.events.emit('nftLoaded')\n    )\n    this.setClearAlpha(0)\n    this.domElement.classList.add(\"filled\")\n    this._arSource = new THREEx.ArToolkitSource(\n      debugSource || { sourceType: \"webcam\" }\n    )\n    this._arSource.init(this._onResize_binded)\n    window.addEventListener(\"resize\", this._onResize_binded)\n    this._arContext = new THREEx.ArToolkitContext({\n      cameraParametersUrl:\n        'https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.1.0' +\n        '/data/data/camera_para.dat',\n      detectionMode: \"mono\"\n    })\n  }\n\n  async init() {\n    if (this._contextReady) return\n    return new Promise<void>(resolve =>\n      this._arContext.init(() => {\n        for (let scene of this._scenes)\n          this._sceneToContext(scene, this._arContext)\n        this.events.emit('contextReady')\n        this._contextReady = true\n        resolve()\n      })\n    )\n  }\n\n  private _firstActivedScene() {\n    for (let scene of this._scenes)\n      if (scene.camera.visible)\n        return this.nowSceneActrual = scene\n  }\n\n  private _looper(time: number) {\n    if (this.running) requestAnimationFrame(this._looper_binded)\n    if (!this._arSource.ready) return\n    if (this.hidden) return this.clear()\n    this._arContext.update(this._arSource.domElement)\n    if (!this.lastTime) this.lastTime = time - 1000 / 60\n    let delta = time - this.lastTime\n\n    for (let func of this.funcs) func(delta, time)\n\n    this.nowSceneActrual = this._firstActivedScene()\n    this._newNowScene()\n    if (this._nowScene) {\n      for (let func of this._nowScene.onTickFuncs)\n        func(delta, time, this._nowScene)\n      this.render(this._nowScene, this._nowScene.camera)\n    }\n\n    this.lastTime = time\n  }\n\n  private _newNowScene() {\n    if (this.nowSceneActrual) {\n      if (this._timerNewNowScene)\n        clearTimeout(this._timerNewNowScene)\n      this._timerNewNowScene = undefined\n      if (this._nowScene === this.nowSceneActrual) return\n      this._setNowScene(this.nowSceneActrual)\n    }\n    else if (this._timerNewNowScene === undefined)\n      this._timerNewNowScene = setTimeout(this._clearNowScene, 2000)\n  }\n\n  private _onResize() {\n    this._arSource.onResizeElement()\n    this._arSource.copyElementSizeTo(this.domElement)\n    if (this._arContext.arController)\n      this._arSource.copyElementSizeTo(\n        this._arContext.arController.canvas\n      )\n  }\n\n  private _sceneToContext(\n    scene: ArScene,\n    context: THREEx.ArToolkitContext\n  ) {\n    if (!scene.marker) return\n    scene.camera.projectionMatrix.copy(context.getProjectionMatrix())\n    return new THREEx.ArMarkerControls(context, scene.camera, {\n      type: \"nft\",\n      descriptorsUrl: scene.marker,\n      changeMatrixMode: \"cameraTransformMatrix\",\n      smoothCount: 60,\n      smoothTolerance: 1,\n      smoothThreshold: 5,\n      smooth: true,\n      size: 0.16\n    })\n  }\n\n  private _setNowScene(scene?: ArScene) {\n    let lastScene = this._nowScene\n    if (lastScene) lastScene.visible = false\n\n    if (scene) {\n      scene.visible = true\n      if (scene instanceof ArModelScene) {\n        let s = 300 / scene.size\n        let content = scene.getObjectByName('content')\n        content && content.scale.set(s, s, s)\n      }\n    }\n    this._nowScene = scene\n    this.clear()\n    this.events.emit('sceneChanged', scene, lastScene)\n  }\n\n  addScene(scene: ArScene) {\n    this._scenes.add(scene)\n    if (this._contextReady)\n      this._sceneToContext(scene, this._arContext)\n  }\n\n  async loadScenes(scenes: ArScene[], processCB?: processCB) {\n    if (!this._contextReady) throw 'Need contextReady first!'\n    let n = 0\n    let total = scenes.length\n    return new Promise<void>(resolve => {\n      let func = () => {\n        processCB && processCB(new ProcessEvent(\n          'ArRender.ArStarting', undefined, n += 1, total))\n        if (n !== total) return\n        this.events.off('nftLoaded', func)\n        resolve()\n      }\n      this.events.on('nftLoaded', func)\n      for (let scene of scenes) {\n        if (!scene.marker) func()\n        this.addScene(scene)\n      }\n    })\n  }\n\n  domTo(container: HTMLElement) {\n    this.setSize(container.offsetWidth, container.offsetHeight)\n    container.appendChild(this.domElement)\n    setInterval(() => this._onResize(), 1000)\n  }\n\n  hide() {\n    this.hidden = true\n    this.pause()\n  }\n\n  pause() {\n    this.running = false\n    if (this._timerNewNowScene) {\n      clearTimeout(this._timerNewNowScene)\n      this._timerNewNowScene = undefined\n    }\n  }\n\n  removeScene(scene: ArScene) {\n    this._scenes.delete(scene)\n  }\n\n  start() {\n    if (this.running) return\n    this.hidden = false\n    this.running = true\n    requestAnimationFrame(this._looper_binded)\n  }\n\n}\n\nexport default ArRender","import ArScene from './ArScene'\nimport ArSceneType from './ArSceneType'\nimport FileMgr from './FileMgr'\nimport MarkerMgr from './MarkerMgr'\n\nclass ArVideoScene extends ArScene {\n\n  videoUrl = ''\n\n  constructor(marker?: marker) {\n    super(marker)\n    this.add(this.camera)\n    this.sceneType = ArSceneType.video\n  }\n\n  static fromDesc(\n    desc: videoSceneDesc,\n    markerMgr = MarkerMgr.instance,\n    fileMgr = FileMgr.instance,\n  ): ArVideoScene {\n    let scene = new ArVideoScene()\n    scene.setWithDesc(desc, markerMgr)\n    let url = fileMgr.getBlobUrl(desc.videoUrl)\n    if (!url) throw `Can't find video: ${url}`\n    scene.videoUrl = url\n    return scene\n  }\n}\n\nexport default ArVideoScene","import ResourceMgr from './ResourceMgr'\r\n\r\nimport ArExpScene from './ArExpScene'\r\nimport ArModelScene from './ArModelScene'\r\nimport ArScene from './ArScene'\r\nimport ArSceneType from './ArSceneType'\r\nimport ArVideoScene from './ArVideoScene'\r\nimport FileMgr from './FileMgr'\r\nimport MarkerMgr from './MarkerMgr'\r\nimport MatMgr from './MatMgr'\r\nimport ModelMgr from './ModelMgr'\r\n\r\nimport { eachChild } from './ObjectHelper'\r\n\r\nclass ArSceneMgr extends ResourceMgr<arSceneDesc, ArScene, string> {\r\n  markerMgr = MarkerMgr.instance\r\n  modelMgr = ModelMgr.instance\r\n  matMgr = MatMgr.instance\r\n  fileMgr = FileMgr.instance\r\n\r\n  static descIsName(desc: arSceneDesc): desc is string {\r\n    return typeof desc === 'string'\r\n  }\r\n\r\n  static descIsModel(desc: arSceneDesc): desc is modelSceneDesc {\r\n    return !ArSceneMgr.descIsName(desc) &&\r\n      desc.sceneType === ArSceneType.model\r\n  }\r\n\r\n  static descIsVideo(desc: arSceneDesc): desc is videoSceneDesc {\r\n    return !ArSceneMgr.descIsName(desc) &&\r\n      desc.sceneType === ArSceneType.video\r\n  }\r\n\r\n  static descIsExp(desc: arSceneDesc): desc is expSceneDesc {\r\n    return !ArSceneMgr.descIsName(desc) &&\r\n      desc.sceneType === ArSceneType.exp\r\n  }\r\n\r\n  static descIsNone(desc: arSceneDesc): desc is expSceneDesc {\r\n    return !ArSceneMgr.descIsName(desc) &&\r\n      desc.sceneType === ArSceneType.none\r\n  }\r\n\r\n  private async _makeScene(\r\n    desc: basicSceneDesc,\r\n    basicReadied?: boolean,\r\n    method = ArScene.fromDesc,\r\n  ) {\r\n    if (!basicReadied) {\r\n      this.regBasicRes(desc)\r\n      await this.initBasicRes()\r\n    }\r\n    let scene = method(desc)\r\n    this.set(scene.name, scene)\r\n    return scene\r\n  }\r\n\r\n  async make(\r\n    desc: arSceneDesc,\r\n    basicReadied?: boolean\r\n  ): Promise<ArScene | void> {\r\n    if (ArSceneMgr.descIsName(desc))\r\n      return this.get(desc)\r\n    let inst = this.get(desc.sceneID)\r\n    if (inst) return inst\r\n    if (ArSceneMgr.descIsModel(desc))\r\n      return this._makeScene(\r\n        desc, basicReadied, ArModelScene.fromDesc)\r\n    else if (ArSceneMgr.descIsVideo(desc))\r\n      return this._makeScene(\r\n        desc, basicReadied, ArVideoScene.fromDesc)\r\n    else if (ArSceneMgr.descIsExp(desc))\r\n      return this._makeScene(\r\n        desc, basicReadied, ArExpScene.fromDesc)\r\n    else\r\n      return this._makeScene(\r\n        desc, basicReadied) // descIsNone\r\n  }\r\n\r\n  regBasicRes_basic(desc: basicSceneDesc) {\r\n    if (desc.markerUrl) this.markerMgr.reg(desc.markerUrl)\r\n  }\r\n\r\n  regBasicRes_model(desc: modelSceneDesc) {\r\n    this.regBasicRes_basic(desc)\r\n    if (desc.children)\r\n      eachChild(desc_model => {\r\n        this.modelMgr.reg(desc_model.model)\r\n        if (desc_model.mat) this.matMgr.reg(desc_model.mat)\r\n      }, desc.children, desc)\r\n  }\r\n\r\n  regBasicRes_video(desc: videoSceneDesc) {\r\n    this.regBasicRes_basic(desc)\r\n    if (desc.videoUrl) this.fileMgr.reg(desc.videoUrl)\r\n  }\r\n\r\n  regBasicRes_exp(desc: expSceneDesc) {\r\n    this.regBasicRes_basic(desc)\r\n    // TODO\r\n  }\r\n\r\n  regBasicRes(...descs: arSceneDesc[]) {\r\n    let _descs = descs.length ? descs : this.unready\r\n    for (let desc of _descs) {\r\n      if (ArSceneMgr.descIsName(desc)) continue\r\n      if (ArSceneMgr.descIsModel(desc))\r\n        this.regBasicRes_model(desc)\r\n      else if (ArSceneMgr.descIsVideo(desc))\r\n        this.regBasicRes_video(desc)\r\n      else if (ArSceneMgr.descIsExp(desc))\r\n        this.regBasicRes_exp(desc)\r\n    }\r\n  }\r\n\r\n  async initBasicRes() {\r\n    await this.markerMgr.init()\r\n    await this.modelMgr.init()\r\n    await this.matMgr.init()\r\n    await this.fileMgr.init()\r\n  }\r\n\r\n  reg(desc: arSceneDesc) {\r\n    if (ArSceneMgr.descIsName(desc)) return\r\n    super.reg(desc)\r\n  }\r\n\r\n  static instance = new ArSceneMgr()\r\n}\r\n\r\nexport default ArSceneMgr","import ArRender from './ArRender'\r\nimport ArSceneMgr from './ArSceneMgr'\r\nimport IDBFS from './IDBFS'\r\nimport IndexedDB from './IndexedDB'\r\nimport IndexFile from './IndexFile'\r\nimport ModelMgr from './ModelMgr'\r\nimport ResourceMgr from './ResourceMgr'\r\nimport ProcessEvent from './ProcessEvent'\r\n\r\ntype indexFileLoadFunc = (...params: any[]) => Promise<IndexFile>\r\n\r\nclass Loader {\r\n  static fs = IDBFS.instance\r\n\r\n  static models = ModelMgr.instance\r\n  static scenes = ArSceneMgr.instance\r\n\r\n  private static _cacheLoaded = false\r\n  private static _resLoaded = false\r\n  private static _arRender?: ArRender\r\n\r\n  static get cacheLoaded() {\r\n    return Loader._cacheLoaded\r\n  }\r\n\r\n  static get loaded() {\r\n    return Loader._arRender !== undefined\r\n  }\r\n\r\n  static get render() {\r\n    return Loader._arRender\r\n  }\r\n\r\n  static get resLoaded() {\r\n    return Loader._resLoaded\r\n  }\r\n\r\n  static loadIndex: indexFileLoadFunc =\r\n    async (url: RequestInfo, init?: RequestInit) => {\r\n      return new IndexFile(await (await fetch(url, init)).text())\r\n    }\r\n\r\n  static loadCache: indexFileLoadFunc = Loader.fs.cachedIndex\r\n\r\n  static async loadCacheFromDB(db: IndexedDB) {\r\n    let result = new IndexFile()\r\n    for await (let [{ name }, hash] of db.items('caches'))\r\n      result.addData(hash.toString(), name)\r\n    return result\r\n  }\r\n\r\n  static processCB?: processCB<any>\r\n\r\n  private static emit(\r\n    type: string,\r\n    loaded = 0,\r\n    total = 1,\r\n    info?: any\r\n  ) {\r\n    if (Loader.processCB) Loader.processCB(\r\n      new ProcessEvent(type, info, loaded, total)\r\n    )\r\n  }\r\n\r\n  private static emitError(type: string, info?: any) {\r\n    if (Loader.processCB) Loader.processCB(\r\n      new ProcessEvent(type, info, 0, 1, false)\r\n    )\r\n  }\r\n\r\n  static async updateCache() {\r\n    if (Loader._cacheLoaded) return\r\n    await Loader.fs.init()\r\n    Loader.emit('Loader.IndexGetting', 1, 2)\r\n    let index: IndexFile | undefined\r\n    try {\r\n      index = await Loader.loadIndex(IDBFS.resServer + '/index.txt')\r\n    } catch (e) {\r\n      Loader.emitError('Loader.IndexFetchError', e)\r\n      let { versionName } = Loader.fs\r\n      if (versionName)\r\n        return Loader.emit('Loader.IndexLocal', 1, 1, { versionName })\r\n      Loader.emitError('Loader.IndexNone')\r\n      throw 'Init Caches Failed!'\r\n    }\r\n    Loader.emit('Loader.IndexDiffsCalcing', 2, 2)\r\n    await Loader.fs.mergeTo(index, Loader.processCB)\r\n    let { versionName } = Loader.fs\r\n    Loader.emit('Loader.IndexNewest', 1, 1, { versionName })\r\n    Loader._cacheLoaded = true\r\n  }\r\n\r\n  static async loadScenes(scenes: arSceneDesc[]) {\r\n    if (Loader._resLoaded) return\r\n    Loader.emit('Loader.ScenesReging')\r\n    for (let url of Loader.fs.find(/models\\//))\r\n      Loader.models.reg({ url })\r\n    for (let scene of scenes) ArSceneMgr.instance.reg(scene)\r\n    Loader.emit('Loader.ScenesReged', 1)\r\n    let initMgr = async (mgr: ResourceMgr<any, any>, t: string) => {\r\n      mgr.processCB = (i, n) => Loader.emit(t, i, n)\r\n      await mgr.init()\r\n      delete mgr.processCB\r\n    }\r\n    await initMgr(Loader.models, 'Loader.ModelsLoading')\r\n    await initMgr(Loader.scenes, 'Loader.ScenesLoading')\r\n    Loader.emit('Loader.ScenesLoaded', 1)\r\n    Loader._resLoaded = true\r\n  }\r\n\r\n  static async initAR(dom: HTMLElement, arSource?: arSourceDesc) {\r\n    if (Loader._arRender) return Loader._arRender\r\n    Loader.emit('Loader.ArIniting')\r\n    let render = new ArRender(arSource)\r\n    render.domTo(dom)\r\n    await render.init()\r\n    Loader.emit('Loader.ArInited', 1)\r\n    return Loader._arRender = render\r\n  }\r\n\r\n  static async startAR() {\r\n    if (!Loader._arRender) throw `Need initAR(dom) first!`\r\n    let render = Loader._arRender\r\n    if (!Loader._resLoaded) throw `Need loadResource(url) first!`\r\n    await render.loadScenes(\r\n      Array.from(Loader.scenes.values()), Loader.processCB)\r\n    render.start()\r\n    Loader.emit('Loader.ArStarted', 1)\r\n  }\r\n\r\n}\r\n\r\nexport default Loader","import {\n  WebGLRenderer,\n  PerspectiveCamera,\n  PCFSoftShadowMap\n} from 'three'\n\nimport ArModelScene from './ArModelScene'\n\nclass ModelRender extends WebGLRenderer {\n\n  private _arScene: ArModelScene | null = null\n  private _looper_binded = this._looper.bind(this)\n  funcs: tickFunc[] = []\n  running = false\n  hidden = false\n  lastTime = 0\n\n  camera = new PerspectiveCamera()\n\n  private _initRender() {\n    this.setClearAlpha(0)\n    this.setPixelRatio(window.devicePixelRatio)\n    this.shadowMap.enabled = true\n    this.shadowMap.type = PCFSoftShadowMap\n  }\n\n  private _initDom() {\n    this.domElement.classList.add('filled')\n    let thisOnResize = () => this._onResize()\n    window.addEventListener('resize', thisOnResize)\n  }\n\n  constructor() {\n    super({ antialias: true, alpha: true })\n    this._initRender()\n    this._initDom()\n  }\n\n  private _looper(time: number) {\n    if (this.running) requestAnimationFrame(this._looper_binded)\n    if (this.hidden) return this.clear()\n    if (!this.lastTime) this.lastTime = time - 1000 / 60\n    let delta = time - this.lastTime\n\n    for (let func of this.funcs) func(delta, time)\n\n    if (this._arScene) {\n      for (let func of this._arScene.onTickFuncs)\n        func(delta, time, this._arScene)\n      this.render(this._arScene, this.camera)\n    }\n\n    this.lastTime = time\n  }\n\n  private _onResize() {\n    if (!this.domElement.parentElement) return\n    let w = this.domElement.parentElement.offsetWidth\n    let h = this.domElement.parentElement.offsetHeight\n    this.setSize(w, h)\n    this.resetCamera()\n  }\n\n  resetCamera() {\n    let w = this.domElement.offsetWidth\n    let h = this.domElement.offsetHeight\n    this.camera.aspect = w / h\n    this.camera.fov = 70\n    this.camera.updateProjectionMatrix()\n  }\n\n  start() {\n    if (this.running) return\n    this.hidden = false\n    this.running = true\n    requestAnimationFrame(this._looper_binded)\n  }\n\n  pause() {\n    this.running = false\n  }\n\n  hide() {\n    this.hidden = true\n    this.pause()\n  }\n\n  domTo(container: HTMLElement) {\n    this.setSize(container.offsetWidth, container.offsetHeight)\n    container.appendChild(this.domElement)\n    setInterval(() => this._onResize(), 2000)\n  }\n\n  get arScene() {\n    return this._arScene\n  }\n\n  set arScene(arScene: ArModelScene | null) {\n    if (this._arScene)\n      this._arScene.visible = false\n    if (arScene) {\n      arScene.visible = true\n      let s = 4 / arScene.size\n      let content = arScene.getObjectByName('content')\n      content && content.scale.set(s, s, s)\n    }\n    this._arScene = arScene\n    this.resetCamera()\n  }\n\n}\n\nexport default ModelRender","import OrbitValue from './OrbitValue'\r\n\r\nclass OrbitController extends OrbitValue {\r\n  nowState: 'none' | 'rotate' | 'zoom' = 'none'\r\n\r\n  private startX = 0\r\n  private startY = 0\r\n  private startDist = 0\r\n  private startValue = new OrbitValue()\r\n\r\n  private updateState(event: TouchEvent | PointerEvent) {\r\n    let changed = false\r\n    let elem = event.srcElement as HTMLElement\r\n    if (event instanceof PointerEvent)\r\n      elem.setPointerCapture(event.pointerId)\r\n    let touches = event instanceof TouchEvent\r\n      ? event.touches : [event]\r\n    if (touches.length === 1 && this.nowState !== 'rotate') {\r\n      changed = true\r\n      this.nowState = \"rotate\"\r\n    }\r\n    if (touches.length > 1 && this.nowState !== 'zoom') {\r\n      changed = true\r\n      this.nowState = \"zoom\"\r\n    }\r\n    if (changed) {\r\n      elem.addEventListener('touchmove', this.touchMove_binded)\r\n      elem.addEventListener('pointermove', this.touchMove_binded)\r\n      elem.addEventListener('touchend', this.touchEnd_binded)\r\n      elem.addEventListener('pointerup', this.touchEnd_binded)\r\n      this.startX = touches[0].clientX\r\n      this.startY = touches[0].clientY\r\n      this.startDist = OrbitController.calcFingerDist(event)\r\n      this.startValue.rotateX = this.rotateX\r\n      this.startValue.rotateY = this.rotateY\r\n      this.startValue.zoom = this.zoom\r\n    }\r\n    return changed\r\n  }\r\n\r\n  listenOn(elem: HTMLElement) {\r\n    elem.addEventListener('touchstart', this.touchStart_binded)\r\n    elem.addEventListener('pointerdown', this.touchStart_binded)\r\n    elem.addEventListener('wheel', this.wheelScroll_binded)\r\n  }\r\n\r\n  unlistenOn(elem: HTMLElement) {\r\n    elem.removeEventListener('touchstart', this.touchStart_binded)\r\n    elem.removeEventListener('pointerdown', this.touchStart_binded)\r\n    elem.removeEventListener('wheel', this.wheelScroll_binded)\r\n  }\r\n\r\n  wheelScroll(event: WheelEvent) {\r\n    this.zoom = OrbitValue.ranges.zoom.fixValue(\r\n      this.zoom - event.deltaY / 200\r\n    )\r\n  }\r\n\r\n  wheelScroll_binded = this.wheelScroll.bind(this)\r\n\r\n  touchStart(\r\n    event: TouchEvent | PointerEvent, continueEvent = false\r\n  ) {\r\n    if (!continueEvent) event.preventDefault()\r\n    this.updateState(event)\r\n  }\r\n\r\n  touchStart_binded = this.touchStart.bind(this)\r\n\r\n  touchMove(\r\n    event: TouchEvent | PointerEvent, continueEvent = false\r\n  ) {\r\n    if (!continueEvent) event.preventDefault()\r\n    this.updateState(event)\r\n    let touches = event instanceof TouchEvent\r\n      ? event.touches : [event]\r\n    if (this.nowState === \"rotate\") {\r\n      this.rotateY = OrbitValue.ranges.rotateY.fixValue(\r\n        this.startValue.rotateY - touches[0].clientX + this.startX\r\n      )\r\n      this.rotateX = OrbitValue.ranges.rotateX.fixValue(\r\n        this.startValue.rotateX + touches[0].clientY - this.startY\r\n      )\r\n    } else                                                 // zoom\r\n      this.zoom = OrbitValue.ranges.zoom.fixValue(\r\n        this.startValue.zoom + (\r\n          OrbitController.calcFingerDist(event) - this.startDist\r\n        ) / 50\r\n      )\r\n\r\n  }\r\n\r\n  touchMove_binded = this.touchMove.bind(this)\r\n\r\n  touchEnd(event: TouchEvent | PointerEvent, continueEvent = false) {\r\n    if (!continueEvent) event.preventDefault()\r\n    let elem = event.srcElement as HTMLElement\r\n    if (event instanceof PointerEvent)\r\n      elem.releasePointerCapture(event.pointerId)\r\n    elem.removeEventListener('touchmove', this.touchMove_binded)\r\n    elem.removeEventListener('pointermove', this.touchMove_binded)\r\n    elem.removeEventListener('touchend', this.touchEnd_binded)\r\n    elem.removeEventListener('pointerup', this.touchEnd_binded)\r\n    this.nowState = 'none'\r\n  }\r\n\r\n  touchEnd_binded = this.touchEnd.bind(this)\r\n\r\n  static calcFingerDist(event: TouchEvent | MouseEvent) {\r\n    if (\r\n      event instanceof MouseEvent || event.touches.length < 2\r\n    ) return 0\r\n    let dx = event.touches[1].clientX - event.touches[0].clientX\r\n    let dy = event.touches[1].clientY - event.touches[0].clientY\r\n    return Math.sqrt(dx * dx + dy * dy)\r\n  }\r\n\r\n}\r\n\r\nexport default OrbitController","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"model-render\",staticClass:\"model-render\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n  * vue-class-component v7.2.3\n  * (c) 2015-present Evan You\n  * @license MIT\n  */\nimport Vue from 'vue';\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\n// The rational behind the verbose Reflect-feature check below is the fact that there are polyfills\n// which add an implementation for Reflect.defineMetadata but not for Reflect.getOwnMetadataKeys.\n// Without this check consumers will encounter hard to track down runtime errors.\nfunction reflectionIsSupported() {\n  return typeof Reflect !== 'undefined' && Reflect.defineMetadata && Reflect.getOwnMetadataKeys;\n}\nfunction copyReflectionMetadata(to, from) {\n  forwardMetadata(to, from);\n  Object.getOwnPropertyNames(from.prototype).forEach(function (key) {\n    forwardMetadata(to.prototype, from.prototype, key);\n  });\n  Object.getOwnPropertyNames(from).forEach(function (key) {\n    forwardMetadata(to, from, key);\n  });\n}\n\nfunction forwardMetadata(to, from, propertyKey) {\n  var metaKeys = propertyKey ? Reflect.getOwnMetadataKeys(from, propertyKey) : Reflect.getOwnMetadataKeys(from);\n  metaKeys.forEach(function (metaKey) {\n    var metadata = propertyKey ? Reflect.getOwnMetadata(metaKey, from, propertyKey) : Reflect.getOwnMetadata(metaKey, from);\n\n    if (propertyKey) {\n      Reflect.defineMetadata(metaKey, metadata, to, propertyKey);\n    } else {\n      Reflect.defineMetadata(metaKey, metadata, to);\n    }\n  });\n}\n\nvar fakeArray = {\n  __proto__: []\n};\nvar hasProto = fakeArray instanceof Array;\nfunction createDecorator(factory) {\n  return function (target, key, index) {\n    var Ctor = typeof target === 'function' ? target : target.constructor;\n\n    if (!Ctor.__decorators__) {\n      Ctor.__decorators__ = [];\n    }\n\n    if (typeof index !== 'number') {\n      index = undefined;\n    }\n\n    Ctor.__decorators__.push(function (options) {\n      return factory(options, key, index);\n    });\n  };\n}\nfunction mixins() {\n  for (var _len = arguments.length, Ctors = new Array(_len), _key = 0; _key < _len; _key++) {\n    Ctors[_key] = arguments[_key];\n  }\n\n  return Vue.extend({\n    mixins: Ctors\n  });\n}\nfunction isPrimitive(value) {\n  var type = _typeof(value);\n\n  return value == null || type !== 'object' && type !== 'function';\n}\nfunction warn(message) {\n  if (typeof console !== 'undefined') {\n    console.warn('[vue-class-component] ' + message);\n  }\n}\n\nfunction collectDataFromConstructor(vm, Component) {\n  // override _init to prevent to init as Vue instance\n  var originalInit = Component.prototype._init;\n\n  Component.prototype._init = function () {\n    var _this = this;\n\n    // proxy to actual vm\n    var keys = Object.getOwnPropertyNames(vm); // 2.2.0 compat (props are no longer exposed as self properties)\n\n    if (vm.$options.props) {\n      for (var key in vm.$options.props) {\n        if (!vm.hasOwnProperty(key)) {\n          keys.push(key);\n        }\n      }\n    }\n\n    keys.forEach(function (key) {\n      if (key.charAt(0) !== '_') {\n        Object.defineProperty(_this, key, {\n          get: function get() {\n            return vm[key];\n          },\n          set: function set(value) {\n            vm[key] = value;\n          },\n          configurable: true\n        });\n      }\n    });\n  }; // should be acquired class property values\n\n\n  var data = new Component(); // restore original _init to avoid memory leak (#209)\n\n  Component.prototype._init = originalInit; // create plain data object\n\n  var plainData = {};\n  Object.keys(data).forEach(function (key) {\n    if (data[key] !== undefined) {\n      plainData[key] = data[key];\n    }\n  });\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (!(Component.prototype instanceof Vue) && Object.keys(plainData).length > 0) {\n      warn('Component class must inherit Vue or its descendant class ' + 'when class property is used.');\n    }\n  }\n\n  return plainData;\n}\n\nvar $internalHooks = ['data', 'beforeCreate', 'created', 'beforeMount', 'mounted', 'beforeDestroy', 'destroyed', 'beforeUpdate', 'updated', 'activated', 'deactivated', 'render', 'errorCaptured', 'serverPrefetch' // 2.6\n];\nfunction componentFactory(Component) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  options.name = options.name || Component._componentTag || Component.name; // prototype props.\n\n  var proto = Component.prototype;\n  Object.getOwnPropertyNames(proto).forEach(function (key) {\n    if (key === 'constructor') {\n      return;\n    } // hooks\n\n\n    if ($internalHooks.indexOf(key) > -1) {\n      options[key] = proto[key];\n      return;\n    }\n\n    var descriptor = Object.getOwnPropertyDescriptor(proto, key);\n\n    if (descriptor.value !== void 0) {\n      // methods\n      if (typeof descriptor.value === 'function') {\n        (options.methods || (options.methods = {}))[key] = descriptor.value;\n      } else {\n        // typescript decorated data\n        (options.mixins || (options.mixins = [])).push({\n          data: function data() {\n            return _defineProperty({}, key, descriptor.value);\n          }\n        });\n      }\n    } else if (descriptor.get || descriptor.set) {\n      // computed properties\n      (options.computed || (options.computed = {}))[key] = {\n        get: descriptor.get,\n        set: descriptor.set\n      };\n    }\n  });\n  (options.mixins || (options.mixins = [])).push({\n    data: function data() {\n      return collectDataFromConstructor(this, Component);\n    }\n  }); // decorate options\n\n  var decorators = Component.__decorators__;\n\n  if (decorators) {\n    decorators.forEach(function (fn) {\n      return fn(options);\n    });\n    delete Component.__decorators__;\n  } // find super\n\n\n  var superProto = Object.getPrototypeOf(Component.prototype);\n  var Super = superProto instanceof Vue ? superProto.constructor : Vue;\n  var Extended = Super.extend(options);\n  forwardStaticMembers(Extended, Component, Super);\n\n  if (reflectionIsSupported()) {\n    copyReflectionMetadata(Extended, Component);\n  }\n\n  return Extended;\n}\nvar reservedPropertyNames = [// Unique id\n'cid', // Super Vue constructor\n'super', // Component options that will be used by the component\n'options', 'superOptions', 'extendOptions', 'sealedOptions', // Private assets\n'component', 'directive', 'filter'];\nvar shouldIgnore = {\n  prototype: true,\n  arguments: true,\n  callee: true,\n  caller: true\n};\n\nfunction forwardStaticMembers(Extended, Original, Super) {\n  // We have to use getOwnPropertyNames since Babel registers methods as non-enumerable\n  Object.getOwnPropertyNames(Original).forEach(function (key) {\n    // Skip the properties that should not be overwritten\n    if (shouldIgnore[key]) {\n      return;\n    } // Some browsers does not allow reconfigure built-in properties\n\n\n    var extendedDescriptor = Object.getOwnPropertyDescriptor(Extended, key);\n\n    if (extendedDescriptor && !extendedDescriptor.configurable) {\n      return;\n    }\n\n    var descriptor = Object.getOwnPropertyDescriptor(Original, key); // If the user agent does not support `__proto__` or its family (IE <= 10),\n    // the sub class properties may be inherited properties from the super class in TypeScript.\n    // We need to exclude such properties to prevent to overwrite\n    // the component options object which stored on the extended constructor (See #192).\n    // If the value is a referenced value (object or function),\n    // we can check equality of them and exclude it if they have the same reference.\n    // If it is a primitive value, it will be forwarded for safety.\n\n    if (!hasProto) {\n      // Only `cid` is explicitly exluded from property forwarding\n      // because we cannot detect whether it is a inherited property or not\n      // on the no `__proto__` environment even though the property is reserved.\n      if (key === 'cid') {\n        return;\n      }\n\n      var superDescriptor = Object.getOwnPropertyDescriptor(Super, key);\n\n      if (!isPrimitive(descriptor.value) && superDescriptor && superDescriptor.value === descriptor.value) {\n        return;\n      }\n    } // Warn if the users manually declare reserved properties\n\n\n    if (process.env.NODE_ENV !== 'production' && reservedPropertyNames.indexOf(key) >= 0) {\n      warn(\"Static property name '\".concat(key, \"' declared on class '\").concat(Original.name, \"' \") + 'conflicts with reserved property name of Vue internal. ' + 'It may cause unexpected behavior of the component. Consider renaming the property.');\n    }\n\n    Object.defineProperty(Extended, key, descriptor);\n  });\n}\n\nfunction Component(options) {\n  if (typeof options === 'function') {\n    return componentFactory(options);\n  }\n\n  return function (Component) {\n    return componentFactory(Component, options);\n  };\n}\n\nComponent.registerHooks = function registerHooks(keys) {\n  $internalHooks.push.apply($internalHooks, _toConsumableArray(keys));\n};\n\nexport default Component;\nexport { createDecorator, mixins };\n","/** vue-property-decorator verson 8.4.2 MIT LICENSE copyright 2019 kaorun343 */\n/// <reference types='reflect-metadata'/>\n'use strict';\nimport Vue from 'vue';\nimport Component, { createDecorator, mixins } from 'vue-class-component';\nexport { Component, Vue, mixins as Mixins };\n/** Used for keying reactive provide/inject properties */\nvar reactiveInjectKey = '__reactiveInject__';\n/**\n * decorator of an inject\n * @param from key\n * @return PropertyDecorator\n */\nexport function Inject(options) {\n    return createDecorator(function (componentOptions, key) {\n        if (typeof componentOptions.inject === 'undefined') {\n            componentOptions.inject = {};\n        }\n        if (!Array.isArray(componentOptions.inject)) {\n            componentOptions.inject[key] = options || key;\n        }\n    });\n}\n/**\n * decorator of a reactive inject\n * @param from key\n * @return PropertyDecorator\n */\nexport function InjectReactive(options) {\n    return createDecorator(function (componentOptions, key) {\n        if (typeof componentOptions.inject === 'undefined') {\n            componentOptions.inject = {};\n        }\n        if (!Array.isArray(componentOptions.inject)) {\n            var fromKey_1 = !!options ? options.from || options : key;\n            var defaultVal_1 = (!!options && options.default) || undefined;\n            if (!componentOptions.computed)\n                componentOptions.computed = {};\n            componentOptions.computed[key] = function () {\n                var obj = this[reactiveInjectKey];\n                return obj ? obj[fromKey_1] : defaultVal_1;\n            };\n            componentOptions.inject[reactiveInjectKey] = reactiveInjectKey;\n        }\n    });\n}\nfunction produceProvide(original) {\n    var provide = function () {\n        var _this = this;\n        var rv = typeof original === 'function' ? original.call(this) : original;\n        rv = Object.create(rv || null);\n        // set reactive services (propagates previous services if necessary)\n        rv[reactiveInjectKey] = this[reactiveInjectKey] || {};\n        for (var i in provide.managed) {\n            rv[provide.managed[i]] = this[i];\n        }\n        var _loop_1 = function (i) {\n            rv[provide.managedReactive[i]] = this_1[i]; // Duplicates the behavior of `@Provide`\n            if (!rv[reactiveInjectKey].hasOwnProperty(provide.managedReactive[i])) {\n                Object.defineProperty(rv[reactiveInjectKey], provide.managedReactive[i], {\n                    enumerable: true,\n                    get: function () { return _this[i]; },\n                });\n            }\n        };\n        var this_1 = this;\n        for (var i in provide.managedReactive) {\n            _loop_1(i);\n        }\n        return rv;\n    };\n    provide.managed = {};\n    provide.managedReactive = {};\n    return provide;\n}\nfunction needToProduceProvide(original) {\n    return (typeof original !== 'function' ||\n        (!original.managed && !original.managedReactive));\n}\n/**\n * decorator of a provide\n * @param key key\n * @return PropertyDecorator | void\n */\nexport function Provide(key) {\n    return createDecorator(function (componentOptions, k) {\n        var provide = componentOptions.provide;\n        if (needToProduceProvide(provide)) {\n            provide = componentOptions.provide = produceProvide(provide);\n        }\n        provide.managed[k] = key || k;\n    });\n}\n/**\n * decorator of a reactive provide\n * @param key key\n * @return PropertyDecorator | void\n */\nexport function ProvideReactive(key) {\n    return createDecorator(function (componentOptions, k) {\n        var provide = componentOptions.provide;\n        // inject parent reactive services (if any)\n        if (!Array.isArray(componentOptions.inject)) {\n            componentOptions.inject = componentOptions.inject || {};\n            componentOptions.inject[reactiveInjectKey] = {\n                from: reactiveInjectKey,\n                default: {},\n            };\n        }\n        if (needToProduceProvide(provide)) {\n            provide = componentOptions.provide = produceProvide(provide);\n        }\n        provide.managedReactive[k] = key || k;\n    });\n}\n/** @see {@link https://github.com/vuejs/vue-class-component/blob/master/src/reflect.ts} */\nvar reflectMetadataIsSupported = typeof Reflect !== 'undefined' && typeof Reflect.getMetadata !== 'undefined';\nfunction applyMetadata(options, target, key) {\n    if (reflectMetadataIsSupported) {\n        if (!Array.isArray(options) &&\n            typeof options !== 'function' &&\n            typeof options.type === 'undefined') {\n            var type = Reflect.getMetadata('design:type', target, key);\n            if (type !== Object) {\n                options.type = type;\n            }\n        }\n    }\n}\n/**\n * decorator of model\n * @param  event event name\n * @param options options\n * @return PropertyDecorator\n */\nexport function Model(event, options) {\n    if (options === void 0) { options = {}; }\n    return function (target, key) {\n        applyMetadata(options, target, key);\n        createDecorator(function (componentOptions, k) {\n            ;\n            (componentOptions.props || (componentOptions.props = {}))[k] = options;\n            componentOptions.model = { prop: k, event: event || k };\n        })(target, key);\n    };\n}\n/**\n * decorator of a prop\n * @param  options the options for the prop\n * @return PropertyDecorator | void\n */\nexport function Prop(options) {\n    if (options === void 0) { options = {}; }\n    return function (target, key) {\n        applyMetadata(options, target, key);\n        createDecorator(function (componentOptions, k) {\n            ;\n            (componentOptions.props || (componentOptions.props = {}))[k] = options;\n        })(target, key);\n    };\n}\n/**\n * decorator of a synced prop\n * @param propName the name to interface with from outside, must be different from decorated property\n * @param options the options for the synced prop\n * @return PropertyDecorator | void\n */\nexport function PropSync(propName, options) {\n    if (options === void 0) { options = {}; }\n    // @ts-ignore\n    return function (target, key) {\n        applyMetadata(options, target, key);\n        createDecorator(function (componentOptions, k) {\n            ;\n            (componentOptions.props || (componentOptions.props = {}))[propName] = options;\n            (componentOptions.computed || (componentOptions.computed = {}))[k] = {\n                get: function () {\n                    return this[propName];\n                },\n                set: function (value) {\n                    // @ts-ignore\n                    this.$emit(\"update:\" + propName, value);\n                },\n            };\n        })(target, key);\n    };\n}\n/**\n * decorator of a watch function\n * @param  path the path or the expression to observe\n * @param  WatchOption\n * @return MethodDecorator\n */\nexport function Watch(path, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.deep, deep = _a === void 0 ? false : _a, _b = options.immediate, immediate = _b === void 0 ? false : _b;\n    return createDecorator(function (componentOptions, handler) {\n        if (typeof componentOptions.watch !== 'object') {\n            componentOptions.watch = Object.create(null);\n        }\n        var watch = componentOptions.watch;\n        if (typeof watch[path] === 'object' && !Array.isArray(watch[path])) {\n            watch[path] = [watch[path]];\n        }\n        else if (typeof watch[path] === 'undefined') {\n            watch[path] = [];\n        }\n        watch[path].push({ handler: handler, deep: deep, immediate: immediate });\n    });\n}\n// Code copied from Vue/src/shared/util.js\nvar hyphenateRE = /\\B([A-Z])/g;\nvar hyphenate = function (str) { return str.replace(hyphenateRE, '-$1').toLowerCase(); };\n/**\n * decorator of an event-emitter function\n * @param  event The name of the event\n * @return MethodDecorator\n */\nexport function Emit(event) {\n    return function (_target, propertyKey, descriptor) {\n        var key = hyphenate(propertyKey);\n        var original = descriptor.value;\n        descriptor.value = function emitter() {\n            var _this = this;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            var emit = function (returnValue) {\n                var emitName = event || key;\n                if (returnValue === undefined) {\n                    if (args.length === 0) {\n                        _this.$emit(emitName);\n                    }\n                    else if (args.length === 1) {\n                        _this.$emit(emitName, args[0]);\n                    }\n                    else {\n                        _this.$emit.apply(_this, [emitName].concat(args));\n                    }\n                }\n                else {\n                    if (args.length === 0) {\n                        _this.$emit(emitName, returnValue);\n                    }\n                    else if (args.length === 1) {\n                        _this.$emit(emitName, returnValue, args[0]);\n                    }\n                    else {\n                        _this.$emit.apply(_this, [emitName, returnValue].concat(args));\n                    }\n                }\n            };\n            var returnValue = original.apply(this, args);\n            if (isPromise(returnValue)) {\n                returnValue.then(function (returnValue) {\n                    emit(returnValue);\n                });\n            }\n            else {\n                emit(returnValue);\n            }\n            return returnValue;\n        };\n    };\n}\n/**\n * decorator of a ref prop\n * @param refKey the ref key defined in template\n */\nexport function Ref(refKey) {\n    return createDecorator(function (options, key) {\n        options.computed = options.computed || {};\n        options.computed[key] = {\n            cache: false,\n            get: function () {\n                return this.$refs[refKey || key];\n            },\n        };\n    });\n}\nfunction isPromise(obj) {\n    return obj instanceof Promise || (obj && typeof obj.then === 'function');\n}\n","\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator'\r\n\r\nimport ArModelScene from '../../ArModelScene'\r\nimport ModelRender from '../../ModelRender'\r\nimport OrbitController from '../../OrbitController'\r\nimport NumberRange from '../../NumberRange'\r\n\r\n@Component\r\nexport default class ModelViewer extends Vue {\r\n  nowScene?: ArModelScene\r\n  modelRender?: ModelRender\r\n  @Prop({ default: true }) orbitView!: boolean\r\n  @Prop({ default: 'on' }) light!: lightType\r\n  @Prop({ default: 'origin' }) mat!: matType\r\n  @Prop({ default: true }) shadow!: boolean\r\n  viewController = new OrbitController()\r\n\r\n  mounted() {\r\n    this.modelRender = new ModelRender()\r\n    let elem = this.$refs['model-render'] as HTMLElement\r\n    this.modelRender.domTo(elem)\r\n    this.orbitViewChanged()\r\n    this.cameraPosChange(this.viewController.cameraPosition)\r\n    this.modelRender.start()\r\n  }\r\n\r\n  beforeDestroy() {\r\n    this.modelRender!.pause()\r\n  }\r\n\r\n  useScene(scene: ArModelScene) {\r\n    this.nowScene = scene\r\n    this.modelRender!.arScene = scene\r\n    this.viewController.center = scene.center\r\n    this.lightChanged()\r\n    this.matChanged()\r\n  }\r\n\r\n  @Watch('light') lightChanged() {\r\n    if (this.nowScene) this.nowScene.light = this.light\r\n  }\r\n\r\n  @Watch('mat') matChanged() {\r\n    if (this.nowScene) this.nowScene.mat = this.mat\r\n  }\r\n\r\n  @Watch('shadow') shadowChanged() {\r\n    if (this.nowScene) this.nowScene.renderShadow = this.shadow\r\n  }\r\n\r\n  @Watch('orbitView') orbitViewChanged() {\r\n    let elem = this.$refs['model-render'] as HTMLElement\r\n    if (this.orbitView) this.viewController.listenOn(elem)\r\n    else this.viewController.unlistenOn(elem)\r\n  }\r\n\r\n  @Watch('viewController.cameraPosition') cameraPosChange(pos: xyz) {\r\n    this.modelRender!.camera.position.set(...pos)\r\n    this.modelRender!.camera.lookAt(0, 0, 0)\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--11-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModelViewer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--11-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ModelViewer.vue?vue&type=script&lang=ts&\"","/* globals __VUE_SSR_CONTEXT__ */\n\n// IMPORTANT: Do NOT use ES2015 features in this file (except for modules).\n// This module is a runtime utility for cleaner component module output and will\n// be included in the final webpack user bundle.\n\nexport default function normalizeComponent (\n  scriptExports,\n  render,\n  staticRenderFns,\n  functionalTemplate,\n  injectStyles,\n  scopeId,\n  moduleIdentifier, /* server only */\n  shadowMode /* vue-cli only */\n) {\n  // Vue.extend constructor export interop\n  var options = typeof scriptExports === 'function'\n    ? scriptExports.options\n    : scriptExports\n\n  // render functions\n  if (render) {\n    options.render = render\n    options.staticRenderFns = staticRenderFns\n    options._compiled = true\n  }\n\n  // functional template\n  if (functionalTemplate) {\n    options.functional = true\n  }\n\n  // scopedId\n  if (scopeId) {\n    options._scopeId = 'data-v-' + scopeId\n  }\n\n  var hook\n  if (moduleIdentifier) { // server build\n    hook = function (context) {\n      // 2.3 injection\n      context =\n        context || // cached call\n        (this.$vnode && this.$vnode.ssrContext) || // stateful\n        (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext) // functional\n      // 2.2 with runInNewContext: true\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__\n      }\n      // inject component styles\n      if (injectStyles) {\n        injectStyles.call(this, context)\n      }\n      // register component module identifier for async chunk inferrence\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier)\n      }\n    }\n    // used by ssr in case component is cached and beforeCreate\n    // never gets called\n    options._ssrRegister = hook\n  } else if (injectStyles) {\n    hook = shadowMode\n      ? function () {\n        injectStyles.call(\n          this,\n          (options.functional ? this.parent : this).$root.$options.shadowRoot\n        )\n      }\n      : injectStyles\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // for template-only hot-reload because in that case the render fn doesn't\n      // go through the normalizer\n      options._injectStyles = hook\n      // register for functional component in vue file\n      var originalRender = options.render\n      options.render = function renderWithStyleInjection (h, context) {\n        hook.call(context)\n        return originalRender(h, context)\n      }\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate\n      options.beforeCreate = existing\n        ? [].concat(existing, hook)\n        : [hook]\n    }\n  }\n\n  return {\n    exports: scriptExports,\n    options: options\n  }\n}\n","import { render, staticRenderFns } from \"./ModelViewer.vue?vue&type=template&id=01b2b452&lang=pug&\"\nimport script from \"./ModelViewer.vue?vue&type=script&lang=ts&\"\nexport * from \"./ModelViewer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export async function tryAwait<T>(\r\n  func: (...params: any[]) => Promise<T>,\r\n  ...params: any[]\r\n): Promise<T | void> {\r\n  try {\r\n    return await func(...params)\r\n  } catch (e) { }\r\n}\r\n\r\nexport async function sleep(ms: number) {\r\n  return new Promise<number>(resolve => setTimeout(resolve, ms))\r\n}\r\n\r\nexport function numsToStr(nums: number[], pad = 0, split = '') {\r\n  return nums.map(n => n.toString().padStart(pad, '0')).join(split)\r\n}\r\n\r\nexport function yyyymmdd(date?: Date, split = '') {\r\n  if (!date) date = new Date()\r\n  return numsToStr([\r\n    date.getFullYear(), date.getMonth() + 1, date.getDate()\r\n  ], 2, split)\r\n}\r\n\r\nexport function hhmmss(date?: Date, split = '') {\r\n  if (!date) date = new Date()\r\n  return numsToStr([\r\n    date.getHours(), date.getMinutes(), date.getSeconds()\r\n  ], 2, split)\r\n}"],"sourceRoot":""}